function shuffle(e){for(var t,a,r=e.length;0!==r;)a=Math.floor(Math.random()*r),r-=1,t=e[r],e[r]=e[a],e[a]=t;return e}function shuffleArray(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[a],e[a]=r}return e}function convertTimeToAMPM(e){var t=e,a=+t.substr(0,2),r=a%12||12,n=a<12?"AM":"PM";return t=r+t.substr(2,3)+n}function dynamicSort(e){return function(t,a){return t[e]<a[e]?-1:t[e]>a[e]?1:0}}function getCirclePreloaderTpl(e){return"<div class='uil-spin-css' style='margin:0 auto;-webkit-transform:scale("+e+"); transform:scale("+e+");-ms-transform:scale("+e+");'><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div></div>"}function getRandom(){return Math.random()}function getRandomArbitary(e,t){return Math.random()*(t-e)+e}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function stripFirstZero(e){return Number(e).toString()}function getTimeStampMouth(e){}function isArabic(e){var t=new RegExp(/[\u0600-\u06FF]/);return t.test(e)}function intentOver(){if($(this).data("megamenu")){main.settings.mobile_check&&$(this).hasClass("active")&&(window.location.href=$(this).attr("href")),main.settings.mobile_check&&e.preventDefault();var t=$(this).data();siteHeader.resetMegaMenu(),siteHeader.setMegaMenu(t.megamenu),$(this).addClass("active")}}function intentOut(){siteHeader.resetMegaMenu()}function sortlist(e){var t=$(e),a=t.children("li:nth-child(n+3)").get();a.sort(function(e,t){return $(e).text().toUpperCase().localeCompare($(t).text().toUpperCase())}),$.each(a,function(e,a){t.append(a)})}function mainsearchrenderCategories(e){var t='<option value="">'+window.MyDeckLocaleData.data.topsearch.categoryTopOption+"</option>",a=[];$.each(e,function(e,t){$.each(t.categories,function(e,t){$.inArray(t.name,a)==-1&&a.push(t.name)})}),a.sort(),$.each(a,function(e,a){t+='<option value="'+a+'">'+a+"</option>"}),$("#search-shop-category").html(t)}function fnmanagenotification(e){if(1==e){var t=window.MyDeckLocaleData.data.topsearch.noResultMsg;$("#yourSearch").html(t.replace("%SEARCH_TEXT%",$("#q").val())),$("#main-top-srch-refine-srch").hasClass("hidden")||$("#main-top-srch-refine-srch").addClass("hidden"),$("#main-top-srch-srch-again").removeClass("hidden")}else{var a=window.MyDeckLocaleData.data.topsearch.showResultMsg;$("#yourSearch").html(a.replace("%SEARCH_TEXT%",$("#q").val())),$("#main-top-srch-srch-again").hasClass("hidden")||$("#main-top-srch-srch-again").addClass("hidden"),$("#main-top-srch-refine-srch").removeClass("hidden")}}function FnManageRelatedSearchShops(){if(ArrMainSrchRelatedShops.length>0){var e=Handlebars.compile($("#store-search-item-tpl").html());$("#related-filteredShop").html(e(ArrMainSrchRelatedShops.slice(0,relatedshop_itemsToShow))),$("#related-filteredShop:first .list").removeClass("hidden"),$("#related-filteredShop-parent").removeClass("hidden"),ArrMainSrchRelatedShops.length>=9?$("#relatedshop-showMore").show():$("#relatedshop-showMore").hide(),0==ArrMainSrchExactShops.length&&($("#filteredShop-parent").hasClass("hidden")||$("#filteredShop-parent").addClass("hidden"))}else $("#related-filteredShop-parent").hasClass("hidden")||$("#related-filteredShop-parent").addClass("hidden"),0==ArrMainSrchExactShops.length&&($("#filteredShop-parent").hasClass("hidden")||$("#filteredShop-parent").addClass("hidden"))}function FnShopShowMore(){$("#filteredShop:first .list").removeClass("hidden3");var e=itemsToShow+9,t=0,a=$("#q").val().toLowerCase(),r=new RegExp("^"+a+"$","i"),n=$("#search-shop-category").val();itemsToShow=e,ArrMainSrchExactShops=[],$.each(ArrMainSrchAllShops,function(i,o){""==n?(r.test(o.name)||appModules.filterData.filterSearchkeyWithStoreTags(a,o.tags,1))&&(ArrMainSrchExactShops.push(o),t>=e?$("#filteredShop #main-top-srch-shop-"+o.id).addClass("hidden3"):$("#filteredShop #main-top-srch-shop-"+o.id).removeClass("hidden3"),t++):(r.test(o.name)||appModules.filterData.filterSearchkeyWithStoreTags(a,o.tags,1))&&appModules.filterData.filterSearchkeyWithStoreTags(n,o.categories,1)&&(ArrMainSrchExactShops.push(o),t>=e?$("#filteredShop #main-top-srch-shop-"+o.id).addClass("hidden3"):$("#filteredShop #main-top-srch-shop-"+o.id).removeClass("hidden3"),t++)});var i=$("#filteredShop:first .list:visible").length;i<=e&&i>=countShop?$("#showMore").hide():$("#showMore").show()}function FnRelatedShopShowMore(){var e=relatedshop_itemsToShow+9;$("#related-filteredShop").html("");var t=Handlebars.compile($("#store-search-item-tpl").html());$("#related-filteredShop").html(t(ArrMainSrchRelatedShops.slice(0,e))),relatedshop_itemsToShow=e,$("#related-filteredShop:first .list").removeClass("hidden");var a=$("#related-filteredShop:first .list:visible").length;ArrMainSrchRelatedShops.length>a?$("#relatedshop-showMore").show():$("#relatedshop-showMore").hide()}function FnOfferShowMore(){var e=$("#filteredOffer").find(".panel-card:visible").size(),t=Handlebars.compile($("#offer-search-item-tpl").html());ArrMainSrchExactOffers.length>0&&($("#filteredOffer").append(t(ArrMainSrchExactOffers.slice(e,e+3))),$("#filteredOffer:first .list").removeClass("hidden"));var e=$("#filteredOffer").find(".panel-card:visible").size();e==ArrMainSrchExactOffers.length?$("#offershowMore").hide():0!=e?$("#offershowMore").show():$("#offershowMore").hide(),alignElements()}function FnRelatedOfferShowMore(){var e=$("#related-filteredOffer").find(".panel-card:visible").size(),t=Handlebars.compile($("#offer-search-item-tpl").html());ArrMainSrchRelatedOffers.length>0&&($("#related-filteredOffer").append(t(ArrMainSrchRelatedOffers.slice(e,e+3))),$("#related-filteredOffer:first .list").removeClass("hidden"));var e=$("#related-filteredOffer").find(".panel-card:visible").size();e==ArrMainSrchRelatedOffers.length?$("#related-offershowMore").hide():0!=e?$("#related-offershowMore").show():$("#related-offershowMore").hide(),alignElements()}function FnEventShowMore(){var e=$("#filteredEvent").find(".panel-card:visible").size(),t=Handlebars.compile($("#event-search-item-tpl").html());ArrMainSrchExactEvents.length>0&&($("#filteredEvent").append(t(ArrMainSrchExactEvents.slice(e,e+3))),$("#filteredEvent:first .list").removeClass("hidden"));var e=$("#filteredEvent").find(".panel-card:visible").size();e==ArrMainSrchExactEvents.length?$("#eventshowMore").hide():0!=e?$("#eventshowMore").show():$("#eventshowMore").hide(),alignElements()}function FnRelatedEventShowMore(){var e=$("#related-filteredEvent").find(".panel-card:visible").size(),t=Handlebars.compile($("#event-search-item-tpl").html());ArrMainSrchRelatedEvents.length>0&&($("#related-filteredEvent").append(t(ArrMainSrchRelatedEvents.slice(e,e+3))),$("#related-filteredEvent:first .list").removeClass("hidden"));var e=$("#related-filteredEvent").find(".panel-card:visible").size();e==ArrMainSrchRelatedEvents.length?$("#related-eventshowMore").hide():0!=e?$("#related-eventshowMore").show():$("#related-eventshowMore").hide(),alignElements()}function alignElements(){}function showMore(){$("#filteredShop:first .list").removeClass("hidden3");var e=itemsToShow+9,t=0,a=$("#q").val().toLowerCase();itemsToShow=e,$("#filteredShop:first .list").each(function(){$(this).children().children().children("h2").text().toLowerCase().search(new RegExp(a,"i"))>=0&&(t>=e?$(this).addClass("hidden3"):$(this).removeClass("hidden3"),t++)});var r=$("#filteredShop:first .list:visible").length;r<=e&&r>=countShop?$("#showMore").hide():$("#showMore").show();var n=parseInt(r)+parseInt(count2)+parseInt(count3);$("#srch_count_all").text(n),$("#srch_count_shop").text(parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)),$("#srch_count_offer").text(count2),$("#srch_count_event").text(count3)}function reinitNestedSlick(){var e=$(this).find(".collapse.in"),t=$(e).find(".slick-overview");$(t).slick("unslick"),$(t).slick({arrows:!0,dots:!0,infinite:!0,fade:!1,slidesToShow:1,slidesToScroll:1})}window.console||(window.console={});for(var m=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],i=0;i<m.length;i++)window.console[m[i]]||(window.console[m[i]]=function(){});var FLAG_SPOTLIGHT=1,FLAG_DON_T_MISS=2,FLAG_TOP_PICKS=4,FLAG_FIRST_LOOK=8,FLAG_FEATURED=16,FLAG_HOME_PAGE=32,buildNamespace=function(e,t,a){var r,n,i=e.split(t||".git "),o=a||window;for(r=0,n=i.length;r<n;r++)o=o[i[r]]=o[i[r]]||{};return o},getNameSpace=function(e,t){var a,r=e.split(t||"."),n=window;for(i=0,a=r.length;i<a;i++)n=n[r[i]];return n},validateEmailAddress=function(e){var t=/^((([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z\s?]{2,5}){1,25})*(\s*?;\s*?)*)*$/i;return t.test(e)},decodeHtml=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value};String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,a){return"undefined"!=typeof e[a]?e[a]:t})}),function(){var e=[0,1,2,3,4,5,6];Date.prototype.getDayName=function(){return e[this.getDay()]}}();var now=new Date,currentDay=now.getDayName(),sortBy=function(){var e=Object.prototype.toString,t=function(e){return e},a=function(t){return this.parser("[object Object]"===e.call(t)&&t[this.prop]||t)};return function(r,n){return r instanceof Array&&r.length?("[object Object]"!==e.call(n)&&(n={}),"function"!=typeof n.parser&&(n.parser=t),n.desc=[1,-1][+!!n.desc],r.sort(function(e,t){return e=a.call(n,e),t=a.call(n,t),((e>t)-(t>e))*n.desc})):[]}}(),main={settings:{mobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),mobile_check:!1,click:"click",hover:"mousemove"}};main.settings.mobile?(main.settings.mobile_check=!0,main.settings.click="touchstart",main.settings.hover="touchstart",main.settings.enter="touchstart"):(main.settings.mobile_check=!1,main.settings.click="click",main.settings.hover="mousemove",main.settings.enter="mouseenter"),window.projectConfig={namespace:"MC.Sites.Emaar.DubaiMall.Mydeck",instagram:{localMeasureWidgetID:"688eecba15573692b9329cdc456bcefd4d7486548bf86b32944f42f70af5"},projectSettings:{},formValidation:{delay:100,custom:{cemail:function(e){return validateEmailAddress(e.val())}},errors:{cemail:"Email is invalid"}}},buildNamespace(window.projectConfig.namespace+".modules",".");var mainApp=window.mainApp=getNameSpace("MC.Sites.Emaar.DubaiMall.Mydeck"),appModules=getNameSpace("MC.Sites.Emaar.DubaiMall.Mydeck.modules");$.ajaxSetup({cache:!1}),function(e,t,a){"use strict";var r,n=e.lazySizes&&lazySizes.cfg||e.lazySizesConfig,i=t.createElement("img"),o="sizes"in i&&"srcset"in i;if(n||(n={},e.lazySizesConfig=n),n.supportsType||(n.supportsType=function(e){return!e}),!(e.picturefill||e.respimage||n.pf)){if(e.HTMLPictureElement&&o)return void(n.pf=function(){});n.pf=function(t){var a,n;if(!e.picturefill&&!e.respimage)for(a=0,n=t.elements.length;a<n;a++)r(t.elements[a])},r=function(){var a=function(e,t){return e.w-t.w},i=/^\s*\d+px\s*$/,s=function(e){var t,a,r=e.length,n=e[r-1],i=0;for(i;i<r;i++)if(n=e[i],n.d=n.w/e.w,n.d>=e.d){!n.cached&&(t=e[i-1])&&t.d>e.d-.13*Math.pow(e.d,2.2)&&(a=Math.pow(t.d-.6,1.6),t.cached&&(t.d+=.15*a),t.d+(n.d-e.d)*a>e.d&&(n=t));break}return n},l=function(){var e,t=/(([^,\s].[^\s]+)\s+(\d+)w)/g,a=/\s+\d+h/g,r=/\s/,n=function(t,a,r,n){e.push({c:a,u:r,w:1*n})};return function(i){return e=[],i=i.trim(),i.replace(a,"").replace(t,n),e.length||!i||r.test(i)||e.push({c:i,u:i,w:99}),e}}(),c=function(){c.init||(c.init=!0,addEventListener("resize",function(){var e,a=t.getElementsByClassName("lazymatchmedia"),n=function(){var e,t;for(e=0,t=a.length;e<t;e++)r(a[e])};return function(){clearTimeout(e),e=setTimeout(n,66)}}()))},d=function(t,a){var r,i=t.getAttribute("srcset")||t.getAttribute(n.srcsetAttr);!i&&a&&(i=t._lazypolyfill?t._lazypolyfill._set:t.getAttribute("src")||t.getAttribute(n.srcAttr)),t._lazypolyfill&&t._lazypolyfill._set==i||(r=l(i||""),a&&t.parentNode&&(r.isPicture="PICTURE"==t.parentNode.nodeName.toUpperCase(),r.isPicture&&(e.matchMedia||e.Modernizr&&Modernizr.mq)&&(lazySizes.aC(t,"lazymatchmedia"),c())),r._set=i,Object.defineProperty(t,"_lazypolyfill",{value:r,writable:!0}))},u=function(t){var a=e.devicePixelRatio||1,r=lazySizes.getX&&lazySizes.getX(t);return Math.min(r||a,2.5,a)},h=function(t){return e.matchMedia?(h=function(e){return!e||(matchMedia(e)||{}).matches})(t):e.Modernizr&&Modernizr.mq?!t||Modernizr.mq(t):!t},f=function(e){var t,r,o,l,c,f,p;if(l=e,d(l,!0),c=l._lazypolyfill,c.isPicture)for(r=0,t=e.parentNode.getElementsByTagName("source"),o=t.length;r<o;r++)if(n.supportsType(t[r].getAttribute("type"),e)&&h(t[r].getAttribute("media"))){l=t[r],d(l),c=l._lazypolyfill;break}return c.length>1?(p=l.getAttribute("sizes")||"",p=i.test(p)&&parseInt(p,10)||lazySizes.gW(e,e.parentNode),c.d=u(e),(!c.w||c.w<p)&&(c.w=p,f=s(c.sort(a)))):f=c[0],f},p=function(e){if(!o||!e.parentNode||"PICTURE"==e.parentNode.nodeName.toUpperCase()){var t=f(e);t&&t.u&&e._lazypolyfill.cur!=t.u&&(e._lazypolyfill.cur=t.u,t.cached=!0,e.setAttribute(n.srcAttr,t.u),e.setAttribute("src",t.u))}};return p.parse=l,p}(),n.loadedClass&&n.loadingClass&&!function(){var e=[];['img[sizes$="px"][srcset].',"picture > img:not([srcset])."].forEach(function(t){e.push(t+n.loadedClass),e.push(t+n.loadingClass)}),n.pf({elements:t.querySelectorAll(e.join(", "))})}()}}(window,document),function(e){"use strict";var t,a=e.createElement("img");!("srcset"in a)||"sizes"in a||window.HTMLPictureElement||(t=/^picture$/i,e.addEventListener("lazybeforeunveil",function(a){var r,n,i,o,s,l,c;!a.defaultPrevented&&!lazySizesConfig.noIOSFix&&(r=a.target)&&(i=r.getAttribute(lazySizesConfig.srcsetAttr))&&(n=r.parentNode)&&((s=t.test(n.nodeName||""))||(o=r.getAttribute("sizes")||r.getAttribute(lazySizesConfig.sizesAttr)))&&(l=s?n:e.createElement("picture"),r._lazyImgSrc||Object.defineProperty(r,"_lazyImgSrc",{value:e.createElement("source"),writable:!0}),c=r._lazyImgSrc,o&&c.setAttribute("sizes",o),c.setAttribute(lazySizesConfig.srcsetAttr,i),r.setAttribute("data-pfsrcset",i),r.removeAttribute(lazySizesConfig.srcsetAttr),s||(n.insertBefore(l,r),l.appendChild(r)),l.insertBefore(c,r))}))}(document),function(e){e.fn.extend({accordion:function(){return this.each(function(){function e(e,a){$(e).parent(s).siblings().removeClass(r).children(i).slideUp(o),$(e).siblings(i)[a||n]("show"==a&&o,function(){$(e).siblings(i).is(":visible")?$(e).parents(s).not(t.parents()).addClass(r):$(e).parent(s).removeClass(r),"show"==a&&$(e).parents(s).not(t.parents()).addClass(r),$(e).parents().show()})}var t=$(this),a="accordiated",r="active",n="slideToggle",i="ul, div",o="fast",s="li";if(t.data(a))return!1;$.each(t.find("ul, li>div"),function(){$(this).data(a,!0),$(this).hide()}),$.each(t.find("a"),function(){$(this).click(function(t){e(this,n)}),$(this).bind("activate-node",function(){t.find(i).not($(this).parents()).not($(this).siblings()).slideUp(o),e(this,"slideDown")})});var l=location.hash?t.find("a[href="+location.hash+"]")[0]:t.find("li.current a")[0];l&&e(l,!1)})}})}(jQuery),function(e,t,a,r){function n(t,a){this.$elm=e(t),this.options=e.extend({},i,a),this.options.idHash+=Math.floor(100*Math.random())+(new Date).getSeconds()+(new Date).getMilliseconds(),this.init()}var i={svgWidth:20,svgHeight:20,idHash:"",svgSource:"",svgContent:"",rootElm:"html",rootFlag:"inverted"};n.prototype={init:function(){var t=this.$elm,a=this.options;a.svgWidth=t.width(),a.svgHeight=t.height(),a.svgSource=t.attr("src"),a.svgContent='<svg xmlns="http://www.w3.org/2000/svg" id="svgroot_'+a.idHash+'" class="'+t[0].className+' " viewBox="0 0 '+a.svgWidth+" "+a.svgHeight+'" width="'+a.svgWidth+'" height="'+a.svgHeight+'">',a.svgContent+="<defs>",a.svgContent+='<filter id="filtersPicture_'+a.idHash+'" >',a.svgContent+='<feComposite result="inputTo_'+a.idHash+'" in="SourceGraphic" in2="SourceGraphic" operator="arithmetic" k1="0" k2="1" k3="0" k4="0" />',a.svgContent+='<feColorMatrix in="SourceGraphic" type="matrix" values="-1 0 0 0 1 0 -1 0 0 1 0 0 -1 0 1 0 0 0 1 0"/>',a.svgContent+="</feComponentTransfer>",a.svgContent+="</filter>",a.svgContent+="</defs>",a.svgContent+="<image filter=\"url('#filtersPicture_"+a.idHash+'\')" x="0" y="0" width="'+a.svgWidth+'" height="'+a.svgHeight+'" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="'+a.svgSource+'" />',a.svgContent+="</svg>",t.addClass("hide"),this.$elm.after(a.svgContent),e(a.rootElm).addClass(a.rootFlag)},destroy:function(){var t=this.$elm,a=this.options;e(a.rootElm).removeClass(a.rootFlag),t.removeClass("hide").removeData("cj.invertImages").next("svg").remove()}},e.fn.invertImages=function(t){if(!Modernizr||!Modernizr.cssfilters)return this.each(function(){var a=(e(this),e(this).data("cj.invertImages")),r="object"==typeof t?t:{};a||e.data(this,"cj.invertImages",new n(this,r)),a&&"string"==typeof t&&a[t]()})}}(jQuery,window,document),function(e){e.fn.hideKeyboard=function(){var e=this.filter("input").attr("readonly","readonly"),t=this.filter("textarea").attr("disabled","true");return setTimeout(function(){e.blur().removeAttr("readonly"),t.blur().removeAttr("disabled")},100),this}}(jQuery),function(e){e.fn.levenshteinDistance=function(e,t){for(var a=e.length,r=t.length,n=[],i=0;i<=a;i++){n.push([]);for(var o=0;o<=r;o++)n[i][o]=0}for(var i=1;i<=a;i++)for(var o=1;o<=r;o++)0==o?n[i][o]=i:0==i?n[i][o]=o:n[i][o]=[n[i-1][o-1]+(e[i-1]!=t[o-1]),n[i][o-1]+1,n[i-1][o]+1].sort()[0];return n[a][r]}}(jQuery),function(e,t,a,r){e(t).ready(function(){}),e(a).resize(r.changed(function(){}))}(jQuery,document,window,ResponsiveBootstrapToolkit),Handlebars.registerHelper("get_length",function(e){return e.length}),Handlebars.registerHelper("ifCondJb",function(e,t){return e==t?'<div class="block block-border-right col-sm-8 col-xs-24" data-block style="border-right: 0; word-wrap: break-word;">':'<div class="block block-border-right col-sm-8 col-xs-24" data-block style="border-right: 2px solid #FFF; word-wrap: break-word;">'}),Handlebars.registerHelper("ifCondJb2",function(e,t){var a="ar"!=GblDefaultLang?"There are currently no other active offers":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§Ù„ÙŠØ§ Ø£ÙŠ Ø¹Ø±ÙˆØ¶ Ù†Ø´Ø·Ø© Ø£Ø®Ø±Ù‰";if(e==t)return'<div class="block block-border-right col-sm-8 col-xs-24 blockLandingOffer" data-block><div class="block-bottom sg-mb-25px blockDineLandingOffers"><div class="container-fluid shop"><div class="row"><div class="col-sm-24 "><p style="text-align: center; margin-top: -48% !important;">'+a+"</p></div></div></div></div></div>"}),Handlebars.registerHelper("log",function(e){console.log(e)}),Handlebars.registerHelper("prettifyDate",function(e){return moment(new Date(e.fn(this))).format("d MMM")}),Handlebars.registerHelper("timeToAMPM",function(e){return convertTimeToAMPM(e.fn(this))}),Handlebars.registerHelper("fromToDate",function(e,t){return moment.locale("en"),e=e.replace(/-/g,"/"),t=t.replace(/-/g,"/"),moment(new Date(e)).format("DD MMM")+" - "+moment(new Date(t)).format("DD MMM YYYY")}),Handlebars.registerHelper("capitalize",function(e){if(null!=e&&e.length>1){var t=e.substring(0,1);t.toUpperCase();var a=e.substring(1,e.length);if(a.indexOf("&")!=-1){var a=e.replace("&amp;","&"),r=a.indexOf("&"),n=a.substring(0,r),i=a.substring(r+2,r+3);return t+n.substring(1,n.length).toLowerCase()+" & "+i.toUpperCase()+a.substring(r+3,a.length).toLowerCase()}return t+a.toLowerCase()}return e}),Handlebars.registerHelper("substr",function(e,t){var a=t.hash,r=a.start||0,n=a.max,i=e.substr(r,n);return e.length>n&&(i+="..."),new Handlebars.SafeString(i)}),Handlebars.registerHelper("striptags",function(e,t){if(null==e)return"";var a=t.hash,r=a.start||0,n=a.max,i=e.replace(/(<([^>]+)>)/gi,"");return a.max&&(i=i.substr(r,n),e.length>n&&(i+="...")),new Handlebars.SafeString(i)}),Handlebars.registerHelper("toUpperCase",function(e){return"en"==GblDefaultLang&&null!=e?new Handlebars.SafeString(e.toUpperCase()):e}),Handlebars.registerHelper("inc",function(e,t){return parseInt(e)+1}),Handlebars.registerHelper("renderNthItem",function(e,t,a){if(parseInt(e+1)%t===0)return a.fn(this)}),Handlebars.registerHelper("if_eq",function(e,t,a){return e==t?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("ifCond",function(e,t,a,r){switch(t){case"==":return e==a?r.fn(this):r.inverse(this);case"===":return e===a?r.fn(this):r.inverse(this);case"<":return e<a?r.fn(this):r.inverse(this);case"<=":return e<=a?r.fn(this):r.inverse(this);case">":return e>a?r.fn(this):r.inverse(this);case">=":return e>=a?r.fn(this):r.inverse(this);case"!=":return e!=a?r.fn(this):r.inverse(this);case"&&":return e&&a?r.fn(this):r.inverse(this);case"||":return e||a?r.fn(this):r.inverse(this);default:return r.inverse(this)}}),Handlebars.registerHelper("dateFormat",function(e,t){if(window.moment){var a=t.hash.format||"MMM DD, YYYY hh:mm:ss A";return moment(e).format(a)}return e}),Handlebars.registerHelper("makeTwoLines",function(e){if(null!=e&&e.length<1||null==e)return"";var t=e.split("<br>");return t.length>1?'<span class="mega-str1">'+t[0]+'</span><br><span class="mega-str2">'+t[1]+"</span>":'<span class="mega-str1">'+t[0]+"</span>"}),Handlebars.registerHelper("consoleLog",function(e){console.log(e)}),Handlebars.registerHelper("fashionAvenueEventsVideoLinkClass",function(e){return"undefined"!=typeof e&&e&&""!=e?" ":" disp-none "}),Handlebars.registerHelper("fashionAvenueEventsVideoLinkClass",function(e){return"undefined"!=typeof e&&e&&""!=e?" ":" disp-none "}),Handlebars.registerHelper("faGetEventDate",function(e,t){var a=$("#fashion-avenue-insert-events").data("falangmouth");if(!a||a.length<1)return"";a=a.split(",");var r=moment(e),n=moment(t),i=stripFirstZero(r.format("DD")),o=a[parseInt(stripFirstZero(r.format("MM")))-1],s=r.format("YYYY"),l=stripFirstZero(n.format("DD")),c=a[parseInt(stripFirstZero(n.format("MM")))-1],d=n.format("YYYY"),u="";return u=o==c?o+" "+i+" - "+l+", "+d:s==d?o+" "+i+" - "+c+" "+l+", "+d:o+" "+i+", "+s+" - "+c+" "+l+", "+d}),Handlebars.registerHelper("get",function(e,t){var a=$("#fashion-avenue-insert-events").data("falangmouth");if(!a||a.length<1)return"";a=a.split(",");var r=moment(e),n=moment(t),i=stripFirstZero(r.format("DD")),o=a[parseInt(stripFirstZero(r.format("MM")))-1],s=stripFirstZero(n.format("DD")),l=a[parseInt(stripFirstZero(n.format("MM")))-1],c="";return c=i==i&&o==l?l+", "+s:o+", "+i+" - "+l+", "+s}),Handlebars.registerHelper("getActiveByIndex",function(e){return 0==e?" active ":""}),Handlebars.registerHelper("renderFaSpotlightSliderImages",function(e){for(var t=$(".block-fa-spotlight-container").data("deckurl"),a="",r="local"==e.type?"":t,n=e.img,i=0;i<n.length;i++){var o=0==i?" active ":"";a=a+'<div class="item '+o+'" style="background-image: url('+r+n[i]+');"></div>'}return a}),Handlebars.registerHelper("storeEntertainRouting",function(e){return appModules.filterData.filterEntertainCategoryIdMatch(e)?"entertain-detail":"shop"}),appModules.myDeck=function(){function e(e,t){var a=localStorage.getItem(e),t=t,r=(new Date).getTime(),n=r-t;return a<n}function t(){try{return localStorage.setItem("test","1"),localStorage.removeItem("test"),!0}catch(e){return!1}}function a(e,t){try{localStorage.setItem(e,t)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||console.log("Error in Local Storage Setup")}}function r(){""!=n("TDM_LANG")?GblDefaultLang!=n("TDM_LANG")&&(localStorage.clear(),document.cookie="TDM_LANG="+GblDefaultLang+";path=/"):(localStorage.clear(),document.cookie="TDM_LANG="+GblDefaultLang+";path=/")}function n(e){var t=e+"=";try{for(var a=decodeURIComponent(document.cookie),r=a.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}catch(o){return console.log(o),""}}var i={},o=!1,s=0,l=0,c=0,d=0,u=[],h=[],f=[],p={},g=function(e){$.ajaxSetup({data:{lang:GblDefaultLang}});var t=null;switch(e.lastIndexOf("/")!=-1&&(t=e.substring(e.lastIndexOf("/")+1,e.length),e=e.substring(0,e.lastIndexOf("/"))),e){case"stores":return $.ajax({url:"/en/data/get-all-stores",dataType:"json",crossDomain:!0});case"offers":return $.ajax({url:"/en/data/get-all-offers",dataType:"json",crossDomain:!0});case"events":return $.ajax({url:"/en/data/get-all-events",dataType:"json",crossDomain:!0});case"homeCarousel":return $.ajax({url:"/en/data/get-home-carousel",dataType:"json",crossDomain:!0});case"subcategories":return $.ajax({url:"/en/data/get-subcategories",dataType:"json",crossDomain:!0});case"subCategoryById":return $.ajax({url:"/en/data/get-categories",dataType:"json",crossDomain:!0});case"get-planyourvisit-openings":return null!==t?$.ajax({url:"/en/data/get-planyourvisit-openings/"+t,dataType:"json",crossDomain:!0}):$.ajax({url:"/en/data/get-planyourvisit-openings",dataType:"json",crossDomain:!0});case"categories":return null!==t?$.ajax({url:"/en/data/get-subcategories/"+t,dataType:"json",crossDomain:!0}):$.ajax({url:"/en/data/get-subcategories",dataType:"json",crossDomain:!0});case"products":return $.ajax({url:"/en/data/get-all-products",dataType:"json",crossDomain:!0});case"entertainment":return $.ajax({url:"/en/data/get-entertain-items",dataType:"json",crossDomain:!0});case"stay":return $.ajax({url:"/en/data/get-stay-items",dataType:"json",crossDomain:!0});case"entertain-stay":return $.ajax({url:"/en/data/get-entertain-stay-items",dataType:"json",crossDomain:!0});case"ads-whatsnew-topPicks":return $.ajax({url:"/en/data/get-ads-whatsnew-toppicks",dataType:"json",crossDomain:!0});case"ads-dontmiss":return $.ajax({url:"/en/data/get-ads-whatsnew-dontmiss",dataType:"json",crossDomain:!0});case"ads-whatsnew-firstLook":return $.ajax({url:"/en/data/get-ads-whatsnew-firstlook",dataType:"json",crossDomain:!0});case"mallInfo":return $.ajax({url:"/en/data/get-mall-info",dataType:"json",crossDomain:!0});case"mallInformation":return $.ajax({url:"/en/data/get-mall-info",dataType:"json",crossDomain:!0});case"get-ads-whatsnew-spotlight":return $.ajax({url:"/en/data/get-ads-whatsnew-spotlight",dataType:"json",crossDomain:!0})}};return i.customAjaxCall=function(e,t){var a=$.ajax({url:e,dataType:"json",crossDomain:!0});$.when(a.then(function(e){o&&console.log(e),t.apply(i,[e,"custom"])}),function(e){o&&console.log("fail",e),t.apply(i,[e,type])})},i.getCategories=function(r){var n="categories",s=3e5;if(!localStorage.getItem("dubai_categories")||e("dubai_categories_lastUpdate",s)){o&&console.log("Building dubai_categories localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_categories",JSON.stringify(e)),a("dubai_categories_lastUpdate",(new Date).getTime())),o&&console.log("dubai_categories localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_categories localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_categories")),r.apply(i,[result,n])},i.getCategoriesById=function(e,t){var a="categories",r=g(a+"/"+e);$.when(r.then(function(e){o&&console.log(e),t.apply(i,[e,a])}),function(e){o&&console.log("fail",e),t.apply(i,[e,a])})},i.getSubCategories=function(r){var n="subcategories",s=3e5;if(!localStorage.getItem("dubai_subcategories")||e("dubai_subcategories_lastUpdate",s)){o&&console.log("Building dubai_subcategories localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_subcategories",JSON.stringify(e)),a("dubai_subcategories_lastUpdate",(new Date).getTime())),o&&console.log("dubai_subcategories localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_subcategories localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_subcategories")),r.apply(i,[result,n])},i.getSubCategoriesById=function(e,t){var a="subCategoryById",r=g(a+"/"+e);$.when(r.then(function(r){var n=[];$.each(r,function(t,a){a.id===e&&(n=a)}),t.apply(i,[n,a])}),function(e){console.log("fail",e),t.apply(i,[e,a])})},i.getStores=function(r){function n(){clearInterval(f)}var l="stores",c=3e5;if("ar"==GblDefaultLang)var d={0:"",1:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø³ÙÙ„ÙŠ",2:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø£Ø±Ø¶ÙŠ",3:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø£ÙˆÙ‘Ù„",4:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø«Ø§Ù†ÙŠ",15:"Ø§Ù„Ø±Ø¯Ù‡Ø©",16:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø«Ø§Ù„Ø«",17:"Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø±Ø§Ø¨Ø¹"};else var d={0:"",1:"Lower Ground Floor",2:"Ground Floor",3:"First Floor",4:"Second Floor",15:"Lobby",16:"Third Floor",17:"Fourth Floor"};if(0===s)if(!localStorage.getItem("dubai_stores")||e("dubai_stores_lastUpdate",c)){s=1,console.log("Building dubai_stores localstorage");var h=g(l);$.when(h.then(function(e){$.each(e,function(e,t){t.floorName=d[t.floorId],"undefined"!=typeof t.name&&(t.name=t.name.trim())}),t()&&(a("dubai_stores",JSON.stringify(e)),a("dubai_stores_lastUpdate",(new Date).getTime())),o&&console.log("dubai_stores localstorage built"),u=e,r.apply(i,[e,l])}),function(e){o&&console.log("fail",e),r.apply(i,[e,l])})}else o&&console.log("dubai_stores localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_stores")),r.apply(i,[result,l]);else var f=setInterval(function(){localStorage.getItem("dubai_stores")?(n(),result=JSON.parse(localStorage.getItem("dubai_stores")),r.apply(i,[result,l])):0!=u.length?(n(),result=u,r.apply(i,[result,l])):console.log("waiting for dubai_stores variable to be set")},500)},i.getStoresById=function(e,t){var a="stores",r=g(a+"/"+e);$.when(r.then(function(e){o&&console.log(e),t.apply(i,[e,a])}),function(e){o&&console.log("fail",e),t.apply(i,[e,a])})},i.getHomeCarousel=function(r){var n="homeCarousel",s=3e5;if(!localStorage.getItem("dubai_homeCarousel")||e("dubai_homeCarousel_lastUpdate",s)){o&&console.log("Building dubai_homeCarousel localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_homeCarousel",JSON.stringify(e)),a("dubai_homeCarousel_lastUpdate",(new Date).getTime())),o&&console.log("dubai_homeCarousel localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_homeCarousel localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_homeCarousel")),r.apply(i,[result,n])},i.getEvents=function(r){function n(){clearInterval(h)}var s="events",l=3e5;if(0===c)if(!localStorage.getItem("dubai_events")||e("dubai_events_lastUpdate",l)){c=1,o&&console.log("Building dubai_events localstorage");var d=g(s);$.when(d.then(function(e){if(void 0!=$("#fashion-avenue-offers-block").html()){var n=[];$.each(e,function(e,t){t.flags&FLAG_DON_T_MISS&&n.push(t)}),appModules.fashionAvenue.renderFpSection(n)}o&&console.log(e);var l=moment(Date.now()).unix(),c=[];$.each(e,function(e,t){moment(t.endDate).unix()>l&&c.push(t)}),f=c,t()&&(a("dubai_events",JSON.stringify(c)),a("dubai_events_lastUpdate",(new Date).getTime())),o&&console.log("dubai_events localstorage built"),r.apply(i,[c,s]),o&&console.log("EVENTS "+c)}),function(e){o&&console.log("fail",e),r.apply(i,[e,s])})}else{if(o&&console.log("dubai_events localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_events")),void 0!=$("#fashion-avenue-offers-block").html()){var u=[];$.each(result,function(e,t){t.flags&FLAG_DON_T_MISS&&u.push(t)}),appModules.fashionAvenue.renderFpSection(u)}r.apply(i,[result,s])}else var h=setInterval(function(){if(localStorage.getItem("dubai_events")){if(n(),result=JSON.parse(localStorage.getItem("dubai_events")),void 0!=$("#fashion-avenue-offers-block").html()){var e=[];$.each(result,function(t,a){a.flags&FLAG_DON_T_MISS&&e.push(a)}),appModules.fashionAvenue.renderFpSection(e)}r.apply(i,[result,s])}else if(0!=f.length){if(n(),result=f,void 0!=$("#fashion-avenue-offers-block").html()){var e=[];$.each(result,function(t,a){a.flags&FLAG_DON_T_MISS&&e.push(a)}),appModules.fashionAvenue.renderFpSection(e)}r.apply(i,[result,s])}else console.log("waiting for dubai_events variable to be set")},500)},i.getEventById=function(e,t){var a="events",r=g(a+"/"+e);$.when(r.then(function(e){o&&console.log(e),t.apply(i,[e,a])}),function(e){o&&console.log("fail",e),t.apply(i,[e,a])})},i.getOffers=function(r){
function n(){clearInterval(u)}var s="offers",c=3e5;if(0===l)if(!localStorage.getItem("dubai_offers")||e("dubai_offers_lastUpdate",c)){l=1,o&&console.log("Building dubai_offers localstorage");var d=g(s);$.when(d.then(function(e){o&&console.log(e);var n=moment(Date.now()).unix(),l=[];$.each(e,function(e,t){moment(t.endDate).unix()>n&&l.push(t)}),h=l,t()&&(a("dubai_offers",JSON.stringify(l)),a("dubai_offers_lastUpdate",(new Date).getTime())),o&&console.log("dubai_offers localstorage built"),r.apply(i,[l,s]),o&&console.log("OFFERS "+l)}),function(e){o&&console.log("fail",e),r.apply(i,[e,s])})}else o&&console.log("dubai_offers localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_offers")),r.apply(i,[result,s]);else var u=setInterval(function(){localStorage.getItem("dubai_offers")?(result=JSON.parse(localStorage.getItem("dubai_offers")),n(),r.apply(i,[result,s])):0!=h.length&&(result=h,n(),r.apply(i,[result,s]))},500)},i.getMallInformation=function(r){function n(){clearInterval(u)}var s="mallInformation",l=3e5;if(0===d)if(!localStorage.getItem("dubai_mallInfo")||e("dubai_mallInfo_lastUpdate",l)){d=1,o&&console.log("Building dubai_mallInfo localstorage");var c=g(s);$.when(c.then(function(e){o&&console.log(e),p=e,t()&&(a("dubai_mallInfo",JSON.stringify(e)),a("dubai_mallInfo_lastUpdate",(new Date).getTime()),o&&console.log("dubai_mallInfo localstorage built")),r.apply(i,[e,s]),o&&console.log("MallInfo "+e)}),function(e){o&&console.log("fail",e),r.apply(i,[e,s])})}else o&&console.log("dubai_mallInfo localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_mallInfo")),r.apply(i,[result,s]);else var u=setInterval(function(){localStorage.getItem("dubai_mallInfo")?(result=JSON.parse(localStorage.getItem("dubai_mallInfo")),n(),r.apply(i,[result,s])):$.isEmptyObject(p)?console.log("waiting for dubai_mallInfo variable to be set"):(result=p,n(),r.apply(i,[result,s]))},500)},i.getMallInfo=function(r){function n(){clearInterval(u)}var s="mallInfo",l=3e5;if(0===d)if(!localStorage.getItem("dubai_mallInfo")||e("dubai_mallInfo_lastUpdate",l)){d=1,o&&console.log("Building dubai_mallInfo localstorage");var c=g(s);$.when(c.then(function(e){o&&console.log(e),p=e,t()&&(a("dubai_mallInfo",JSON.stringify(e)),a("dubai_mallInfo_lastUpdate",(new Date).getTime())),o&&console.log("dubai_mallInfo localstorage built"),r.apply(i,[e,s]),o&&console.log("MallInfo "+e)}),function(e){o&&console.log("fail",e),r.apply(i,[e,s])})}else o&&console.log("dubai_mallInfo localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_mallInfo")),r.apply(i,[result,s]);else var u=setInterval(function(){localStorage.getItem("dubai_mallInfo")?(result=JSON.parse(localStorage.getItem("dubai_mallInfo")),n(),r.apply(i,[result,s])):$.isEmptyObject(p)?console.log("waiting for dubai_mallInfo variable to be set"):(result=p,n(),r.apply(i,[result,s]))},500)},i.getOfferById=function(e,t){var a="offers",r=g(a+"/"+e);$.when(r.then(function(e){o&&console.log(e),t.apply(i,[e,a])}),function(e){o&&console.log("fail",e),t.apply(i,[e,a])})},i.getProducts=function(r){var n="products",s=3e5;if(!localStorage.getItem("dubai_products")||e("dubai_products_lastUpdate",s)){o&&console.log("Building dubai_products localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_products",JSON.stringify(e)),a("dubai_products_lastUpdate",(new Date).getTime())),o&&console.log("dubai_products localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_products localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_products")),r.apply(i,[result,n])},i.getProductById=function(e,t){var a="products",r=g(a+"/"+e);$.when(r.then(function(e){o&&console.log(e),t.apply(i,[e,a])}),function(e){o&&console.log("fail",e),t.apply(i,[e,a])})},i.getWhatsNewTopPics=function(r){var n="ads-whatsnew-topPicks",s=3e5;if(!localStorage.getItem("dubai_ads_whatsnew_topPicks")||e("dubai_ads_whatsnew_topPicks_lastUpdate",s)){o&&console.log("Building dubai_ads_whatsnew_topPicks localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_ads_whatsnew_topPicks",JSON.stringify(e)),a("dubai_ads_whatsnew_topPicks_lastUpdate",(new Date).getTime())),o&&console.log("dubai_ads_whatsnew_topPicks localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_ads_whatsnew_topPicks localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_ads_whatsnew_topPicks")),r.apply(i,[result,n])},i.getWhatsNewDontMiss=function(r){var n="ads-dontmiss",s=3e5;if(!localStorage.getItem("dubai_ads_dontmiss")||e("dubai_ads_dontmiss_lastUpdate",s)){o&&console.log("Building dubai_ads_dontmiss localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_ads_dontmiss",JSON.stringify(e)),a("dubai_ads_dontmiss_lastUpdate",(new Date).getTime())),o&&console.log("dubai_ads_dontmiss localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_ads_dontmiss localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_ads_dontmiss")),r.apply(i,[result,n])},i.getWhatsNewFirstLook=function(r){var n="ads-whatsnew-firstLook",s=3e5;if(!localStorage.getItem("dubai_ads_whatsnew_firstLook")||e("dubai_ads_whatsnew_firstLook_lastUpdate",s)){o&&console.log("Building dubai_ads_whatsnew_firstLook localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_ads_whatsnew_firstLook",JSON.stringify(e)),a("dubai_ads_whatsnew_firstLook_lastUpdate",(new Date).getTime())),o&&console.log("dubai_ads_whatsnew_firstLook localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_ads_whatsnew_firstLook localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_ads_whatsnew_firstLook")),r.apply(i,[result,n])},i.getWhatsNewSpotLight=function(r){var n="get-ads-whatsnew-spotlight",s=3e5;if(!localStorage.getItem("dubai_ads_whatsnew_spotlight")||e("dubai_ads_whatsnew_spotlight_lastUpdate",s)){o&&console.log("Building dubai_ads_whatsnew_spotlight localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_ads_whatsnew_spotlight",JSON.stringify(e)),a("dubai_ads_whatsnew_spotlight_lastUpdate",(new Date).getTime())),o&&console.log("dubai_ads_whatsnew_spotlight localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_ads_whatsnew_spotlight localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_ads_whatsnew_spotlight")),r.apply(i,[result,n])},i.getPlanYourVisitOpenings=function(r,n){var s="get-planyourvisit-openings",l=3e5;if(!localStorage.getItem("dubai_get_planyourvisit_openings_"+r)||e("dubai_get_planyourvisit_openings_lastUpdate",l)){o&&console.log("Building dubai_get_planyourvisit_openings localstorage "+r);var c=g(s);$.when(c.then(function(e){t()&&(a("dubai_get_planyourvisit_openings",JSON.stringify(e)),a("dubai_get_planyourvisit_openings_lastUpdate",(new Date).getTime())),o&&console.log("dubai_get_planyourvisit_openings localstorage built"),o&&console.log(e),n.apply(i,[e,s])}),function(e){o&&console.log("fail",e),n.apply(i,[e,s])})}else o&&console.log("dubai_get_planyourvisit_openings localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_get_planyourvisit_openings")),n.apply(i,[result,s])},i.getEntertainments=function(r){var n="entertainment",s=3e5;if(!localStorage.getItem("dubai_entertainment")||e("dubai_entertainment_lastUpdate",s)){o&&console.log("Building dubai_entertainment localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_entertainment",JSON.stringify(e)),a("dubai_entertainment_lastUpdate",(new Date).getTime())),o&&console.log("dubai_entertainment localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_entertainment localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_entertainment")),r.apply(i,[result,n])},i.getStayItems=function(r){var n="stay",s=3e5;if(!localStorage.getItem("dubai_stay")||e("dubai_stay_lastUpdate",s)){o&&console.log("Building dubai_stay localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_stay",JSON.stringify(e)),a("dubai_stay_lastUpdate",(new Date).getTime())),o&&console.log("dubai_stay localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else o&&console.log("dubai_stay localstorage already in cache"),result=JSON.parse(localStorage.getItem("dubai_stay")),r.apply(i,[result,n])},i.getEntertainmentStayItems=function(r){var n="entertain-stay",s=3e5;if(!localStorage.getItem("dubai_stay")||e("dubai_stay_lastUpdate",s)){o&&console.log("Building dubai_stay localstorage");var l=g(n);$.when(l.then(function(e){t()&&(a("dubai_entertainment",JSON.stringify(e.entertain)),a("dubai_entertainment_lastUpdate",(new Date).getTime())),o&&console.log("dubai_entertainment localstorage built"),t()&&(a("dubai_stay",JSON.stringify(e.stay)),a("dubai_stay_lastUpdate",(new Date).getTime())),o&&console.log("dubai_stay localstorage built"),o&&console.log(e),r.apply(i,[e,n])}),function(e){o&&console.log("fail",e),r.apply(i,[e,n])})}else{o&&console.log("dubai_stay localstorage already in cache");var c=[];c.entertain=JSON.parse(localStorage.getItem("dubai_entertainment")),c.stay=JSON.parse(localStorage.getItem("dubai_stay")),r.apply(i,[c,n])}},i.init=function(){r()},i}(),appModules.storedData=function(){var e,t,a,r,n,i,o={};return o.getStores=function(){return e},o.setStores=function(t){e=t},o.getHomeCarousel=function(){return r},o.setHomeCarousel=function(e){r=e},o.getMallInfo=function(){return i},o.setMallInfo=function(e){i=e},o.getOffers=function(){return t},o.setOffers=function(e){t=e},o.getEvents=function(){return a},o.setEvents=function(e){a=e},o.getProducts=function(){return n},o.setProducts=function(e){n=e},o}(),appModules.filterData=function(){var e={};return e.filterHasCategoryTypeMatch=function(e){for(var t=0;t<e.length;t++){var a=e[t].type,r=5;if(r===a)return!0}return!1},e.getDineCategoriesForFilter=function(e){for(var t=[],a=e.length,r=0;r<a;r++){var n=e[r];this.filterHasCategoryTypeMatch(n.categories)&&t.push(n)}return t},e.filterDoesntHaveCategoryTypeMatch=function(e){for(var t=0;t<e.length;t++){var a=e[t].type,r=5;if(r!==a)return!0}return!1},e.getNonDineCategoriesForFilter=function(e){for(var t=[],a=e.length,r=0;r<a;r++){var n=e[r];this.filterDoesntHaveCategoryTypeMatch(n.categories)&&t.push(n)}return t},e.filterByStoreCategory=function(e,t){if(t.length<=0)return e;for(var a=[],r=e.length,n=0;n<r;n++){var i=e[n];this.filterHasCategoryMatch(i.categories,t)&&a.push(i)}return a},e.filterRealStores=function(e){for(var t=[35,56,65,62,77,68],a=[],r=e.length,n=0;n<r;n++){var i=e[n];this.filterHasCategoryMatch(i.categories,t)||a.push(i)}return a},e.filterRealStores2=function(e,t){for(var a=[],r=t.length,n=0;n<r;n++){var i=t[n];$.each(i.categories,function(e){a.push(this.id)})}for(var o=a,s=[],l=e.length,n=0;n<l;n++){var c=e[n];this.filterHasCategoryMatch(c.categories,o)||s.push(c)}return s},e.filterHasImages=function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a];""!=r.mainPic&&null!=r.mainPic&&t.push(r)}return t},e.filterHasElevatedImage=function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a];""!=r.elevatedPic&&null!=r.elevatedPic&&t.push(r)}return t},e.filterExcludeStoreByCategory=function(e,t){if(t.length<=0)return e;for(var a=[],r=e.length,n=0;n<r;n++){var i=e[n];this.filterHasCategoryMatch(i.categories,t)===!1&&a.push(i)}return a},e.filterExcludeEventOrOfferByCategory=function(e,t){if(t.length<=0)return e;for(var a=[],r=e.length,n=0;n<r;n++){var i=e[n];this.filterHasCategoryMatch(i.targetCategories,t)===!1&&a.push(i)}return a},e.filterHasCategoryMatch=function(e,t){for(var a=0;a<e.length;a++)for(var r=e[a].id,n=0;n<t.length;n++){var i=t[n];if(i===r)return!0}return!1},e.getNewestStore=function(e,t){var a=sortBy(e,{prop:"updateDate",desc:!0});return t&&(a=a.slice(0,t)),a},e.newest=function(e,t){var a=sortBy(e,{prop:"startDate",desc:!0});return t&&(a=a.slice(0,t)),a},e.actual=function(e,t){var a=new Date,r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),n=e.filter(function(e){return moment(r.valueOf()).isAfter(moment(e.startDate,"YYYY-MM-DD HH:mm:ss"))&&moment(r.valueOf()).isBefore(moment(e.endDate,"YYYY-MM-DD HH:mm:ss"))});return t&&(n=n.slice(0,t)),n},e.getStoresByLevel=function(e,t,a){var r=[],n=0;return $.each(e,function(e,i){var o=$.inArray(i.level.toLowerCase(),t);if(o>=0&&(r.push(i),n++,a&&n>=a))return!1}),r},e.getDineByFlags=function(e,t,a){var r=[],n=0;return $.each(e,function(e,i){if(i.flags&a&&(r.push(i),n++,t&&n>=t))return!1}),r},e.getStoreById=function(e,t){var a=null;return $.each(e,function(e,r){if(r.id==t)return a=r,!1}),a},e.getOffersWithStoreNames=function(t,a,r){var n=0,i=[];return $.each(t,function(t,o){var s=e.getStoreById(a,o.storeId);if(null!==s&&(o.additional_storeName=o.storeName,o.storeName=s.name,i.push(o),n++,r&&n>=r))return!1}),i},e.getProductsWithStoreNames=function(t,a,r){var n=0,i=[];return $.each(t,function(t,o){var s=e.getStoreById(a,o.storeId);if(null!==s&&(o.storeName=s.name,i.push(o),n++,r&&n>=r))return!1}),i},e.getRandomDineProduct=function(e,t){var a=null,r=[];do{var n=Math.floor(Math.random()*e.length);a=e[n]}while(void 0!=t&&a.id===t);return r.push(a),r},e.getHotelsFromStores=function(t){return e.filterByStoreCategory(t,[209])},e.sortOnProperty=function(e,t){e.sort(function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0})},e.filterEntertainCategoryIdMatch=function(e){for(var t=0;t<e.length;t++){var a=e[t].id,r=206;if(r===a)return!0}return!1},e.filterSearchkeyWithStoreTags=function(e,t,a){if(""==e)return!0;var r=new RegExp(e,"i");if(void 0!=t)for(var n=0;n<t.length;n++)if(1==a){if(t[n].name.toLowerCase()==e)return!0}else if(r.test(t[n].name.toLowerCase()))return!0;return!1},e}(),appModules.megaMenuEntertainment=function(){var e={},t=".containerMegamenuEntertainment",a="#megaMenuEntertainment-tpl",r=[];return e.buildLogic=function(){var e=Handlebars.compile($(a).html());$(t).html(e(r))},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getEntertainments(function(t,a){r=t,e.buildLogic()})},e}(),appModules.megaMenuStay=function(){var e={},t=".containerMegamenuStay",a="#megaMenuStay-tpl",r=[];return e.buildLogic=function(){var e=Handlebars.compile($(a).html());$(t).html(e(r))},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getStayItems(function(t,a){r=t,e.buildLogic()})},e}(),appModules.megaMenuEntertainmentStay=function(){var e={},t=".containerMegamenuEntertainment",a="#megaMenuEntertainment-tpl",r=[],n=".containerMegamenuStay",i="#megaMenuStay-tpl",o=[];return e.buildLogic=function(){var e=Handlebars.compile($(a).html());$(t).html(e(r));var s=Handlebars.compile($(i).html());$(n).html(s(o))},e.init=function(){$(t,n).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getEntertainmentStayItems(function(t,a){r=t.entertain,o=t.stay,e.buildLogic()})},e}();var siteHeader={settings:{container:".site-header",menu:".site-header__menu",content:".site-content",mobile_active_menu:!1,mm_leader:".site-mega__leader",mm_block:".site-mega__block",mm_overlay:".site-mega__overlay",mm_close:".site-mega__close",mm_active:!1,menu_height:!1,didScroll:!1,lastScrollTop:0,delta:5},resetMegaMenu:function(){var e=this;e.settings.mm_active=!1,$(e.settings.mm_block).hide(),$(e.settings.mm_overlay).hide(),$(e.settings.mm_close).hide(),$("[data-megamenu]").removeClass("active")},setMegaMenu:function(e){var t=this;t.settings.mm_active=e,$(t.settings.mm_active).show(),$(t.settings.mm_overlay).show(),$(t.settings.mm_close).show()},resetSiteMenu:function(){var e=this;$(e.settings.menu).removeClass("nav-up").addClass("nav-down"),$(e.settings.content).removeClass("nav-up").addClass("nav-down")},resetSiteMenuFromLeader:function(){var e=this;e.resetSiteMenu()},setSiteMenu:function(){var e=this;$(e.settings.menu).removeClass("nav-down").addClass("nav-up"),$(e.settings.content).removeClass("nav-down").addClass("nav-up")},scroller:function(){var e=this,t=$(window).scrollTop();e.settings.mm_active||Math.abs(e.settings.lastScrollTop-t)<=e.settings.delta||(t>e.settings.lastScrollTop&&t>e.settings.menu_height+100?e.setSiteMenu():t+$(window).height()<$(document).height()&&e.resetSiteMenu(),e.settings.lastScrollTop=t)},init:function(){var e=this;e.menu_height=$(e.settings.menu).height(),$(e.settings.menu).css({height:e.menu_height})}};$(document).ready(function(){siteHeader.init()}),$(document).scroll(function(){siteHeader.scroller()}),main.settings.mobile_check||($("#nav-main ul li").hoverIntent(function(){$(this).find(".dropdown").stop(!0,!0).slideToggle("500")},function(){}),$(".site-header__menu").hoverIntent({over:intentOver,out:function(){},selector:"[data-megamenu]"})),$(document).on(main.settings.enter,".site-header__leader, .site-mega__close, .site-mega__overlay",function(){siteHeader.resetMegaMenu()}),$(document).on(main.settings.hover,".site-header__leader",function(){siteHeader.resetSiteMenuFromLeader()}),$(window).resize(function(){siteHeader.resetMegaMenu()}),$(window).resize(function(){$(window).width()>766&&0===$(siteHeader.settings.menu).height()&&($(siteHeader.settings.menu).css({height:"auto"}),$(siteHeader.settings.menu).removeClass("nav-up").addClass("nav-down"),$(siteHeader.settings.content).removeClass("nav-up").addClass("nav-down"))}),appModules.instagram=function(){var e={},t=".instagram-slider-mc";return e.buildSlider=function(){appModules.externalApi.getInstagramData(function(e){var a=Handlebars.compile($("#socialFeedFooterSlider-tpl").html());$(t).html(a(e)),$(".instagram-slider-mc").slick({dots:!1,arrows:!0,infinite:!0,speed:300,lazyLoad:"ondemand",slidesToShow:6,slidesToScroll:6,responsive:[{breakpoint:922,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:766,settings:{slidesToShow:1,slidesToScroll:1}}],rtl:"ar"==GblDefaultLang})})},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),e.buildSlider()},e}(),appModules.styleSelectBoxes=function(){var e={};return e.init=function(){$("select").not("#fitness-section select").each(function(){if($(this).hasClass("no-transform"))return!1;var e=$(this),t=$(this).children("option").length;e.addClass("select-hidden"),e.wrap('<div class="select"></div>'),e.after('<div class="select-styled"></div>');var a=e.next("div.select-styled");a.html('<strong class="inner">'+e.children("option").eq(0).text()+'</strong><span class="arrow"></span>');for(var r=$("<ul />",{"class":"select-options"}).insertAfter(a),n=0;n<t;n++)$("<li />",{text:e.children("option").eq(n).text(),rel:e.children("option").eq(n).val()}).appendTo(r);var i=r.children("li");a.click(function(e){e.stopPropagation(),$("div.select-styled.active").each(function(){$(this).toggleClass("active").next("ul.select-options").hide()}),0===$(".select-styled.active").length||$(".select-styled").removeClass("active"),$(this).next("ul.select-options").toggle()}),i.click(function(t){t.stopPropagation(),a.find(".inner").text($(this).text()),a.removeClass("active"),e.val($(this).attr("rel")),r.hide()}),$(document).click(function(){a.removeClass("active"),r.hide()})})},e}(),appModules.selectBoxes=function(){var e=$("div.select> .select-styled"),t={},a={},r={};return t.initEventListenerListItems=function(e){e.on("click",function(e){e.stopPropagation();var t=$(this).data("id"),a=$(this).data("value"),r=$(this).parents("div.select").data("select-group");"ar"==GblDefaultLang&&"shop-alphabet"==r?$(this).parents("div.select").find("strong.inner").text($(this).text()):$(this).parents("div.select").find("strong.inner").text(a);var n=$(this).parents("div.select").find(">.select-styled"),i=n.next();n.trigger("selectionchange",[{id:t,value:a,group:r}]),n.attr("data-selected-id",t).attr("data-selected-value",a),i.hide()})},t.setupEventListeners=function(){$("div.select").on("click",function(e){if(e.stopPropagation(),$(".select-styled").next(".select-options").hide(),a=$(this).find("> .select-styled"),r=a.next(),r.find("li[data-match=true]").length<=0)return void r.hide();r.is(":visible")?r.hide():(a.removeClass("active"),r.show()),$(document).click(function(){a.removeClass("active"),r.hide()});var t=$(this).data("select-group");a.trigger("select",[{group:t}])}),t.initEventListenerListItems($("div.select > ul li"))},t.resetBox=function(e,t){e.find("> ul").hide(),e.find("> .select-styled").removeClass("active"),t&&(e.find('li[data-id="hide"]').text().length?e.find("strong.inner").text(e.find('li[data-id="hide"]').text()):e.find("strong.inner").text(e.data("default-text")))},t.getList=function(){return r},t.getStyledBox=function(){return a},t.getStyledBoxes=function(){return e},t.init=function(){this.setupEventListeners()},t}(),appModules.michelleMap=function(){var e,t,a={};return a.init=function(){e=$("#michello-map"),t=e.attr("src")},a.getUrl=function(){return t+"?rnd="+(new Date).getTime()},a.clear=function(){e.attr("src","").html("")},a.reload=function(){this.clear();var t=this;setTimeout(function(){e.attr("src",t.getUrl())},100)},a.viewMap=function(){var e=window.open(t,"_blank");e.focus()},a}(),appModules.externalApi=function(){var e={};return e.getInstagramData=function(t){var a,r=window.projectConfig.instagram.localMeasureWidgetID,n="https://cdn.getlocalmeasure.com/public/"+r+"/data.js";a=$.ajax({url:n,dataType:"jsonp",jsonpCallback:"jsonCallback_"+r}),$.when(a.then(function(a){t.call(e,a.posts)}),function(a){t.call(e,a)})},e.init=function(){},e}(),appModules.newsletter=function(){var e={},t={},a=function(){t=$(".signup-newsletter").parsley(),$(document).on("submit",".signup-newsletter",function(e){e.preventDefault(),t.isValid()&&r($(this))})},r=function(e){var t=e.serialize();$.ajax({url:"/register",type:"POST",data:t,dataType:"json",success:function(t){"ok"===t.status?($(".modal-newsletter-popup .step-1").addClass("hidden"),$(".modal-newsletter-popup .step-2").removeClass("hidden"),popup=$(".modal-newsletter-popup"),popup.show(),$("body").css("overflow","hidden")):window.mainApp.showNotifyMessage(window.MyDeckLocaleData.data.newsLetter.signUp.msgError,"error"),e.find("input[type=email]").val("")},error:function(e){window.mainApp.showNotifyMessage(window.MyDeckLocaleData.data.newsLetter.signUp.msgError,"error")}})};return e.init=function(){a()},e}(),appModules.newsletterPopup=function(){var e={},t={},a=function(e){var t=e.serialize();$.ajax({url:"/register",type:"POST",data:t,dataType:"json",success:function(t){"ok"===t.status?($(".modal-newsletter-popup .step-1").addClass("hidden"),$(".modal-newsletter-popup .step-2").removeClass("hidden")):window.mainApp.showNotifyMessage(window.MyDeckLocaleData.data.newsLetter.signUp.msgError,"error"),e.find("input[type=email]").val("")},error:function(e){window.mainApp.showNotifyMessage(window.MyDeckLocaleData.data.newsLetter.signUp.msgError,"error")}})},r=function(){var t=$("#newsletter-signup-form").parsley();$(document).on("submit",".modal-newsletter-popup",function(e){e.preventDefault(),t.isValid()&&a($("#newsletter-signup-form"))}),$(document).on("click","[data-newsletter-close]",function(t){e.clearCookie(),t.preventDefault(),$(".modal-newsletter-popup").hide(),$("body").css("overflow","auto")})};return e.show=function(e){setTimeout(function(){t.show(),$("body").css("overflow","hidden");$("#newsletter-signup-form").parsley()},1e3*e)},e.clearCookie=function(){Cookies.remove("newsletter-popup",{path:""}),Cookies.set("newsletter-popup","2")},e.forceShow=function(){this.show(0)},e.init=function(){t=$(".modal-newsletter-popup"),r()},e}(),appModules.fashionAvenue=function(){var e={};return e.defaultImages=["/assets/media/fashion-avenue/fa-slider-1.jpg","/assets/media/fashion-avenue/fa-slider-2.jpg","/assets/media/fashion-avenue/fa-slider-3.jpg"],e.renderFpSection=function(t){var a=e.getRandomItem(t),r=Handlebars.compile($("#fashion-avenue-offers-block").html()),n=r(a);$("#fashion-avenue-insert-events").html(n)},e.getRandomItem=function(e){var t=[];return $.each(e,function(e,a){var r=moment(),n=moment(a.endDate);n>r&&t.push(a)}),t.length>0&&t[getRandomInt(0,t.length-1)]},e.init=function(){var t=$("#block-burb-and-slider");1==t.length&&e.renderSpotlightBlock()},e.renderSpotlightBlock=function(){appModules.myDeck.getStores(function(t){if(t&&!(t.length<1)){var a=$.grep(t,function(e){if(null!=e.location)return 1==e.location.id&&e.flags==FLAG_SPOTLIGHT});if(a&&!(a.length<1)){var r=a[getRandomInt(0,a.length-1)];if(r&&"object"==typeof r){var n=Handlebars.compile($("#fashion-avenue-spotlight-on-block2").html()),i=new Array,o={type:"deck"};e.checkImage(r.plus1Pic)&&i.push(r.plus1Pic),e.checkImage(r.plus2Pic)&&i.push(r.plus2Pic),e.checkImage(r.plus3Pic)&&i.push(r.plus3Pic),0==i.length&&(o.type="local",i=i.concat(e.defaultImages)),o.img=i,r.addonalPics=o,r.mainPic||(r.mainPic="/default/dummy.php");var s=n(r);$(".block-fa-spotlight-container > .block-abs").html(s)}}}})},e.renderFAGuySlider=function(){appModules.myDeck.getWhatsNewSpotLight(function(t){var a=t[0];if(a&&"object"==typeof a){var r=a.store;if(r&&"object"==typeof r){var n=new Array;n.push(r.mainPic),e.checkImage(r.plus1Pic)&&n.push(r.plus1Pic),e.checkImage(r.plus2Pic)&&n.push(r.plus2Pic),e.checkImage(r.plus3Pic)&&n.push(r.plus3Pic),r.images=n;var i=Handlebars.compile($("#fashion-avenue-spotlight-on-stores-slider-block").html()),o=i(r);$("#block-carouser-fa-stores-relation > .block-wrap").html(o)}}})},e.checkImage=function(e){return!("undefined"==typeof e||!e||""==e)},$(document).ready(function(){var e=$("#block-carouser-fa-stores-relation");1==e.length}),e}(),$(".shareTwitter").click(function(e){var t=575,a=400,r=($(window).width()-t)/2,n=($(window).height()-a)/2,i=this.href,o="status=0,width="+t+",height="+a+",top="+n+",left="+r;return window.open(i,"twitter",o),!1}),appModules.pageStoreDirectory=function(){var e={},t=24,a=$("#search-shop-directory"),r=$(".search-shop-directory-button"),n=$(".store-display-indicator"),i=[],o=[],s=[],l=[],c={},d="",u={query:"",categories:"",subcategories:"",searchLetter:"",offersOnly:"false"};return e.getSearchFilter=function(){return u},e.setFilterById=function(t,a){if(!u[t]&&!u.hasOwnProperty(t))throw new Error("Wrong search key used!");u[t]=a,e.runStoreFilter(t)},e.enableSearchButton=function(e){e?r.removeClass("disabled"):r.addClass("disabled")},e.searchButtonEnabled=function(){var e=!0;return r.hasClass("disabled")&&(e=!1),e},e.filterOnKeywordSearchQuery=function(e){o=[],s=[];var t=new RegExp("^"+u.query+"$","i"),a=new RegExp(u.query,"i"),r=new RegExp("\\b"+u.query+"\\b","i"),n=!1;$.each(e,function(e,i){var l="ar"!=GblDefaultLang||isArabic(u.query)?i.name:i.name_en,c="ar"!=GblDefaultLang||isArabic(u.query)?i.description:i.description_en,d="ar"!=GblDefaultLang||isArabic(u.query)?i.tags:i.tags_en;t.test(l)||appModules.filterData.filterSearchkeyWithStoreTags(u.query,d,1)?(o.push(i),n=!0):(a.test(l)||r.test(c)||appModules.filterData.filterSearchkeyWithStoreTags(u.query,d,0))&&(s.push(i),n=!0)}),n?$("#refineStores").removeClass("hidden"):$("#refineStores").addClass("hidden")},e.filterOnKeywordSearchOffers=function(){o=e.filterOnOffers(o),s=e.filterOnOffers(s)},e.filterOnKeywordSearchAtoZ=function(){o=e.filterOnAtoZ(o),s=e.filterOnAtoZ(s)},e.filterOnKeywordSearchCategory=function(){o=e.filterOnCategory(o),s=e.filterOnCategory(s)},e.filterOnKeywordSearchSubCategory=function(){o=e.filterOnSubCategory(o),s=e.filterOnSubCategory(s)},e.filterOnSearchQuery=function(e){var t=[],a=[],r=new RegExp(u.query,"i"),n=u.query.toLowerCase(),i="",o=!1;$.each(e,function(e,s){r.test(s.name)&&(t.push(s),a.push(s.id),o=!0,$("#refineStores").removeClass("hidden")),$.each(s.categories,function(e,n){r.test(n.name)&&$.inArray(s.id,a)==-1&&(a.push(s.id),t.push(s),o=!0,$("#refineStores").removeClass("hidden"))}),s.tags=null==s.tags?[]:s.tags,$.each(s.tags,function(e,n){r.test(n.name)&&$.inArray(s.id,a)==-1&&(a.push(s.id),t.push(s),o=!0,$("#refineStores").removeClass("hidden"))}),o||($("#refineStores").addClass("hidden"),$("#btn-store-directory-load-more").hide(),i=s.name.toLowerCase(),1===$.fn.levenshteinDistance(n,i)&&(d=s.name),d.length<=0&&2===$.fn.levenshteinDistance(n,i)&&(d=s.name),d.length<=0&&3===$.fn.levenshteinDistance(n,i)&&(d=s.name))});var s=$.fn.levenshteinDistance(n,d.toLowerCase());return 0!==s&&4!=s||(d=""),d.length<=0,t},e.filterOnAtoZ=function(e){var t=[];if(!(u.searchLetter.length>0&&"all"!==u.searchLetter))return e;var a=new RegExp("^"+u.searchLetter,"i"),r="";return $.each(e,function(e,n){r="ar"==GblDefaultLang&&void 0!=n.name_en?n.name_en:n.name,a.test(r)&&t.push(n)}),t},e.filterOnOffers=function(e){var t=[];return"true"===u.offersOnly?$.each(e,function(e,a){c[a.id]&&t.push(a)}):t=e,t},e.setHasOfferFlag=function(e){$.each(l,function(e,t){c[t.storeId]=!0}),$.each(e,function(e,t){c[t.id]&&(c[t.id]=t,t.hasOffers=!0)})},e.filterOnCategory=function(e){var t=[];return""===u.categories||"all"===u.categories?e:($.each(e,function(e,a){a.categories&&$.each(a.categories,function(e,r){r.id==u.categories&&t.push(a)})}),t)},e.filterOnSubCategory=function(e){var t=[];return""===u.subcategories||"all"===u.subcategories?e:($.each(e,function(e,a){var r=!1;a.subCategories&&$.each(a.subCategories,function(e,t){t.id==u.subcategories&&(r=!0)}),r&&(t.push(a),r=!1)}),t)},e.runStoreFilter=function(t){o=[],s=[],""==u.query?(o=e.filterOnSearchQuery(i),o=e.filterOnOffers(o),o=e.filterOnAtoZ(o),o=e.filterOnCategory(o),o=e.filterOnSubCategory(o),e.renderFilteredStoreItems(),e.updateLoadMoreButton()):($("#matched-stores-head").removeClass("hidden"),e.filterOnKeywordSearchQuery(i),e.filterOnKeywordSearchOffers(),e.filterOnKeywordSearchAtoZ(),e.filterOnKeywordSearchCategory(),e.filterOnKeywordSearchSubCategory(),e.renderFilteredStoreItems(),e.updateLoadMoreButton(),e.updateRelatedStoresLoadMoreButton())},e.renderFilteredStoreItems=function(){$("#stores-search-result-container-parent .plain-block-grid").html("");var e=Handlebars.compile($("#store-directory-item-tpl").html());$("#stores-search-result-container-parent .plain-block-grid").html(e(o.slice(0,24))),$("#stores-search-result-container-parent").removeClass("hidden"),$("#related-stores-search-result-container-parent .plain-block-grid").html(""),s.length>0?($("#related-stores-search-result-container-parent .plain-block-grid").html(e(s.slice(0,24))),$("#related-stores-search-result-container-parent").removeClass("hidden"),0==o.length&&($("#stores-search-result-container-parent").hasClass("hidden")||$("#stores-search-result-container-parent").addClass("hidden"))):$("#related-stores-search-result-container-parent").hasClass("hidden")||$("#related-stores-search-result-container-parent").addClass("hidden")},e.updateLoadMoreButton=function(){var e;e=o.length>0||$(".input--search").val().length>0?o.length:i.length;var t=$("#stores-search-result-container-parent .plain-block-grid li:visible").size();$(".store-display-indicator").text("Showing "+t+" Results");var a=n.data("label-showing-indicator");if(0===t){n.hide(),$(".all-offers-seperator").hide();window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result").removeClass("hidden"),$("#matched-stores-head").hasClass("hidden")||$("#matched-stores-head").addClass("hidden")}else $(".all-offers-seperator").show(),$(".nosearch-result").addClass("hidden"),n.show(),n.text(a);t===e?$("#btn-store-directory-load-more").hide():0!==t?$("#btn-store-directory-load-more").show():$("#btn-store-directory-load-more").hide()},e.updateRelatedStoresLoadMoreButton=function(){var e=0;if(s.length>0&&(e=s.length),0==e&&o.length<=0){$("a[data-refinesearch-btn]").hide();var t=window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result__message").text(t.replace("%SEARCH_TEXT%",u.query)),$(".nosearch-result").removeClass("hidden")}else $("a[data-refinesearch-btn]").show(),
$(".nosearch-result").addClass("hidden");var a=$("#related-stores-search-result-container-parent .plain-block-grid li:visible").size();a===e?$("#btn-related-store-directory-load-more").hide():0!==a?$("#btn-related-store-directory-load-more").show():$("#btn-related-store-directory-load-more").hide()},e.loadMoreShops=function(){var a=$("#stores-search-result-container-parent .plain-block-grid li:visible").size(),r=Handlebars.compile($("#store-directory-item-tpl").html());o.length>0?$("#stores-search-result-container-parent .plain-block-grid").append(r(o.slice(a,a+t))):$("#stores-search-result-container-parent .plain-block-grid").append(r(i.slice(a,a+t))),e.updateLoadMoreButton()},e.loadMoreRelatedShops=function(){var a=$("#related-stores-search-result-container-parent .plain-block-grid li:visible").size(),r=Handlebars.compile($("#store-directory-item-tpl").html());s.length>0&&$("#related-stores-search-result-container-parent .plain-block-grid").append(r(s.slice(a,a+t))),e.updateRelatedStoresLoadMoreButton()},e.prefillSubCategories=function(e){var t=$('div[data-select-group="subcategories"]').find("> ul");t.html(""),appModules.myDeck.getSubCategoriesById(e,function(e,t){var a=void 0!=e.subCategories?e.subCategories:[];$(".selectbox-subcategories").html("");var r=Handlebars.compile($("#store-subcategories-tpl").html());$(".selectbox-subcategories").html(r(a)),appModules.selectBoxes.initEventListenerListItems($(".selectbox-subcategories li")),a.length?($(".select.subcategories").css({"pointer-events":"auto",opacity:"1"}),sortlist(".selectbox-subcategories")):$(".select.subcategories").css({"pointer-events":"none",opacity:"0.4"})})},e.filterStoreByLocation=function(e){var t=[];return $.each(i,function(a,r){r.location&&r.location.id==e&&t.push(r)}),t},e.filterStoreByTagId=function(e){var t=[];return $.each(i,function(a,r){r.tags&&$.each(r.tags,function(a,n){n.id==e&&t.push(r)})}),t},e.filterStoreByCategoryId=function(e){var t=[];return $.each(i,function(a,r){r.categories&&$.each(r.categories,function(a,n){n.id==e&&t.push(r)})}),t},e.setDropDownCategoryById=function(t){t=parseInt(t);var a=$('div[data-select-group="categories"] ul li');$.each(a,function(a,r){$(r).data("id")===t&&($(r).trigger("click"),e.prefillSubCategories(t))})},e.init=function(){var t=$("#store-directory-item-tpl").data("prefilter");$("#btn-store-directory-load-more").on("click",function(t){t.preventDefault(),e.loadMoreShops()}),$("#btn-related-store-directory-load-more").on("click",function(t){t.preventDefault(),e.loadMoreRelatedShops()}),r.on("click",function(t){t.preventDefault(),a.hideKeyboard(),e.searchButtonEnabled()&&e.runStoreFilter("all")}),$('input[data-checkbox-shop-filter="offers"]').change(function(){$(this).is(":checked")?e.setFilterById("offersOnly","true"):e.setFilterById("offersOnly","false")}),$(".plain-block-grid").html(getCirclePreloaderTpl(.26)),appModules.myDeck.getOffers(function(e,t){l=e}),appModules.myDeck.getStores(function(a,r){i=a,e.setHasOfferFlag(i);var n=Handlebars.compile($("#store-directory-item-tpl").html());t&&t.excludeShopFilter&&(i=appModules.filterData.filterExcludeStoreByCategory(i,t.excludeShopFilter)),t&&t.shopFilter&&(i=appModules.filterData.filterByStoreCategory(i,t.shopFilter)),t&&t.location&&(i=e.filterStoreByLocation(parseInt(t.location))),t&&t.tagId&&(i=e.filterStoreByTagId(parseInt(t.tagId))),appModules.filterData.sortOnProperty(i,"name"),t&&t.categoryId?(u.categories=parseInt(t.categoryId),o=e.filterStoreByCategoryId(parseInt(t.categoryId))):o=i,$(".plain-block-grid").html(n(o.slice(0,24))),void 0!=$("div[data-store-dine]").html()&&1===t.shopFilter.length&&e.prefillSubCategories(t.shopFilter),t&&t.categoryId&&e.setDropDownCategoryById(t.categoryId),e.updateLoadMoreButton()}),$("#search-shop-directory-form").submit(function(e){e.preventDefault()}),$("#search-shop-directory").on("paste",function(t){setTimeout(function(){var t=$("#search-shop-directory").val().toLowerCase().trim();t.length?e.enableSearchButton(!0):e.enableSearchButton(!1),e.setFilterById("query",t)},500)}),a.on("keyup",function(t){var a=$(this).val().toLowerCase().trim();return a.match(reg)?("en"==GblDefaultLang?$("#search-shop-directory-form fieldset ").append('<div class=" added_searchers parsley-errors-list filled text-danger" style="position: absolute; width:100%; left:0px">Invalid Input!  </div>'):$("#search-shop-directory-form fieldset ").append('<div class=" added_searchers parsley-errors-list filled text-danger" style="position: absolute; width:100%; right:0px">Invalid Input! </div>'),void window.setTimeout(function(){$(".added_searchers").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},4e3)):(a.length?e.enableSearchButton(!0):e.enableSearchButton(!1),void e.setFilterById("query",a))}),setTimeout(function(){a.focus()},50),appModules.selectBoxes.getStyledBoxes().on("select",function(e,t){switch(t.group){case"categories":break;case"subcategories":}}),appModules.selectBoxes.getStyledBoxes().on("selectionchange",function(t,a){switch(a.group){case"categories":u.subcategories="",appModules.selectBoxes.resetBox($('div[data-select-group="subcategories"]'),!0),$(".selectbox-subcategories").html("");var r=Handlebars.compile($("#store-subcategories-tpl").html());$(".selectbox-subcategories").html(r([])),e.setFilterById("categories",a.id),e.prefillSubCategories(a.id);break;case"subcategories":e.setFilterById("subcategories",a.id);break;case"shop-alphabet":var n=a.id.toString();"W1"==n?n="W":"Y1"==n&&(n="Y"),e.setFilterById("searchLetter",n)}}),$(".no-transform.shops").on("change",function(t){e.setFilterById("categories",$(this).val())}),$(".no-transform.az").on("change",function(t){e.setFilterById("searchLetter",$(this).val())});var n=$("html, body");$(a).click(function(){n.stop().animate({scrollTop:400},500,"swing")})},e}(),$("#refineStores").on("click",function(e){e.preventDefault(),$(this).addClass("hidden"),$("html, body").animate({scrollTop:$("#search-shop-directory").offset().top},1e3,function(){$("#search-shop-directory").focus()})}),sortlist(".sortcategories"),appModules.pageHome=function(){var e={};return e.init=function(){$(".exploreMoreStayCTA").on("click",function(e){e.preventDefault(),window.open($(this).attr("href"),"_blank")})},e}(),appModules.pageOfferSearch=function(){var e={},t=6,a=[],r=[],n=[],i={query:"",categories:"",sorting:""},o=$("#search-shop-offers"),s=$(".search-shop-offers-button"),l=$("#btn-offers-load-more"),c=$("#btn-offers-related-load-more"),d=$(".offers-display-indicator"),u=$(".offers-search-result-container"),h=$(".related-offers-search-result-container"),f=$("#offers-item-tpl"),p="";return e.getSearchFilter=function(){return i},e.setFilterById=function(t,a){if(!i[t]&&!i.hasOwnProperty(t))throw new Error("Wrong search key used!");i[t]=a,e.runStoreFilter(t)},e.enableSearchButton=function(e){e?s.removeClass("disabled"):s.addClass("disabled")},e.searchButtonEnabled=function(){var e=!0;return s.hasClass("disabled")&&(e=!1),e},e.filterOnKeywordSearchQuery=function(e){r=[],n=[];var t=new RegExp("^"+i.query+"$","i"),a=new RegExp(i.query,"i"),o=new RegExp("\\b"+i.query+"\\b","i"),s=!1;$.each(e,function(e,l){var c="ar"!=GblDefaultLang||isArabic(i.query)?l.name:l.name_en,d="ar"!=GblDefaultLang||isArabic(i.query)?l.store.name:l.store.name_en,u="ar"!=GblDefaultLang||isArabic(i.query)?l.store.tags:l.store.tags_en,h="ar"!=GblDefaultLang||isArabic(i.query)?l.description:l.description_en,f="ar"!=GblDefaultLang||isArabic(i.query)?l.location:l.location_en;t.test(c)||t.test(d)||appModules.filterData.filterSearchkeyWithStoreTags(i.query,u,1)||1==l.options&&t.test(f)?(r.push(l),s=!0):(a.test(c)||o.test(h)||a.test(d)||appModules.filterData.filterSearchkeyWithStoreTags(i.query,u,0)||1==l.options&&a.test(f))&&(n.push(l),s=!0)}),s?$("#refineOffers").removeClass("hidden"):$("#refineOffers").addClass("hidden")},e.filterOnKeywordSearchCategory=function(){""!=i.categories&&"all"!=i.categories&&(r=e.filterOnCategory(r),n=e.filterOnCategory(n))},e.filterOnKeywordSearchDate=function(){r=e.filterOnSorting(r),n=e.filterOnSorting(n)},e.filterOnSearchQuery=function(e){var t=[],a=new RegExp(i.query,"i"),r=i.query.toLowerCase(),n="",o=!1;$.each(e,function(e,i){(a.test(i.name)||a.test(i.description)||a.test(i.store.name)||appModules.filterData.filterSearchkeyWithStoreTags(r,i.store.tags,0)||1==i.options&&a.test(i.location))&&(t.push(i),o=!0,""!=$("#search-shop-offers").val()&&$("#refineOffers").removeClass("hidden")),o||($("#refineOffers").addClass("hidden"),n=i.name.toLowerCase(),1===$.fn.levenshteinDistance(r,n)&&(p=i.name),p.length<=0&&2===$.fn.levenshteinDistance(r,n)&&(p=i.name),p.length<=0&&3===$.fn.levenshteinDistance(r,n)&&(p=i.name))});var s=$.fn.levenshteinDistance(r,p.toLowerCase());return 0!==s&&4!=s||(p=""),p.length<=0,t},e.filterOnCategory=function(e){var t=[];return""===i.categories||"all"===i.categories?e:($.each(e,function(e,a){if(a.targetCategories){var r=!1;$.each(a.targetCategories,function(e,t){if(t.id==i.categories)return r=!0,!1}),r&&t.push(a)}}),t)},e.filterOnSorting=function(e){return e},e.runStoreFilter=function(t){r=[],n=[],""==i.query?($("#matched-offers-head").hasClass("hidden")||$("#matched-offers-head").addClass("hidden"),$("#all-offers-head").removeClass("hidden"),r=e.filterOnSearchQuery(a),r=e.filterOnCategory(r),r=e.filterOnSorting(r),e.renderFilteredItems(),e.updateLoadMoreButton()):($("#all-offers-head").hasClass("hidden")||$("#all-offers-head").addClass("hidden"),$("#matched-offers-head").removeClass("hidden"),e.filterOnKeywordSearchQuery(a),e.filterOnKeywordSearchCategory(),e.filterOnKeywordSearchDate(),e.renderFilteredItems(),e.updateLoadMoreButton(),e.updateRelatedOffersLoadMoreButton())},e.renderFilteredItems=function(){$(u).html("");var e=Handlebars.compile(f.html());u.html(e(r.slice(0,t))),$("#offers-search-result-container-parent").removeClass("hidden"),$(h).html(""),n.length>0?(h.html(e(n.slice(0,t))),$("#related-offers-search-result-container-parent").removeClass("hidden"),0==r.length&&($("#offers-search-result-container-parent").hasClass("hidden")||$("#offers-search-result-container-parent").addClass("hidden"))):$("#related-offers-search-result-container-parent").hasClass("hidden")||$("#related-offers-search-result-container-parent").addClass("hidden")},e.updateLoadMoreButton=function(){var e;e=r.length>0?r.length:a.length;var t=u.find(".panel-card:visible").size(),n=d.data("label-showing-indicator");if(0===t){d.hide(),$(".all-offers-seperator").hide();var o=window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result__message").text(o.replace("%SEARCH_TEXT%",i.query)),$(".nosearch-result").removeClass("hidden"),$("#all-offers-head").hasClass("hidden")||$("#all-offers-head").addClass("hidden"),$("#matched-offers-head").hasClass("hidden")||$("#matched-offers-head").addClass("hidden")}else $(".all-offers-seperator").show(),$(".nosearch-result").addClass("hidden"),d.show(),n=n.replace("%s1%",t),n=n.replace("%s2%"," "+e),d.text(n);t===e?l.hide():0!==t?l.show():l.hide()},e.updateRelatedOffersLoadMoreButton=function(){var e=0;if(n.length>0&&(e=n.length),0==e&&r.length<=0){$("a[data-refinesearch-btn]").hide();var t=window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result__message").text(t.replace("%SEARCH_TEXT%",i.query)),$(".nosearch-result").removeClass("hidden")}else $("a[data-refinesearch-btn]").show(),$(".nosearch-result").addClass("hidden");var a=h.find(".panel-card:visible").size();a===e?c.hide():0!==a?c.show():c.hide()},e.loadMore=function(i){if("related-offers-search-result-container"==i){var o=h.find(".panel-card:visible").size(),s=Handlebars.compile(f.html());n.length>0&&h.append(s(n.slice(o,o+t))),e.updateRelatedOffersLoadMoreButton()}else{var o=u.find(".panel-card:visible").size(),s=Handlebars.compile(f.html());r.length>0?u.append(s(r.slice(o,o+t))):u.append(s(a.slice(o,o+t))),e.updateLoadMoreButton()}},e.init=function(){if($("#search-shop-offers, #categories-select, #ordering-select").on("click",function(){}),setTimeout(function(){o.focus()},50),l.on("click",function(t){t.preventDefault(),e.loadMore("offers-search-result-container")}),c.on("click",function(t){t.preventDefault(),e.loadMore("related-offers-search-result-container")}),s.on("click",function(t){t.preventDefault(),o.hideKeyboard(),e.searchButtonEnabled()&&e.runStoreFilter("all")}),$(u).html(getCirclePreloaderTpl(.26)),appModules.storedData.getOffers()){a=appModules.storedData.getOffers();var r=Handlebars.compile(f.html());u.html(r(a.slice(0,t))),e.setFilterById("sorting","newest")}else appModules.myDeck.getOffers(function(r,n){a=r,appModules.storedData.setOffers(r);var i=Handlebars.compile(f.html());u.html(i(a.slice(0,t))),e.setFilterById("sorting","newest")});s.submit(function(e){e.preventDefault()}),o.on("input",function(t){var a=$(this).val().toLowerCase().trim();a.length?e.enableSearchButton(!0):e.enableSearchButton(!1),e.setFilterById("query",a)}),appModules.selectBoxes.getStyledBoxes().on("select",function(e,t){switch(t.group){case"categories":break;case"sorting":}}),appModules.selectBoxes.getStyledBoxes().on("selectionchange",function(t,a){switch(a.group){case"categories":e.setFilterById("categories",a.id);break;case"sorting":e.setFilterById("sorting",a.id)}}),$(".no-transform.category").on("change",function(t){e.setFilterById("categories",$(this).val())}),$(".no-transform.sorting").on("change",function(t){e.setFilterById("sorting",$(this).val())})},e}(),appModules.pageOfferDetail=function(){var e={};return e.init=function(){var e=$(".slick-slider-container").height();$(".map").css({height:e+43})},e}(),appModules.pageEventSearch=function(){var e={},t=6,a=[],r=[],n=[],i={query:"",dateFilter:"",eventType:""},o=$("#search-shop-events"),s=$(".search-shop-events-button"),l=$("#btn-events-load-more"),c=$("#btn-events-related-load-more"),d=$(".events-display-indicator"),u=$(".events-search-result-container"),h=$(".related-events-search-result-container"),f=$("#events-item-tpl"),p="";return e.getSearchFilter=function(){return i},e.setFilterById=function(t,a){if(!i[t]&&!i.hasOwnProperty(t))throw new Error("Wrong search key used!");i[t]=a,e.runStoreFilter(t)},e.enableSearchButton=function(e){e?s.removeClass("disabled"):s.addClass("disabled")},e.searchButtonEnabled=function(){var e=!0;return s.hasClass("disabled")&&(e=!1),e},e.filterOnKeywordSearchQuery=function(e){r=[],n=[];var t=new RegExp("^"+i.query+"$","i"),a=new RegExp(i.query,"i"),o=new RegExp("\\b"+i.query+"\\b","i"),s=!1;$.each(e,function(e,l){var c="ar"!=GblDefaultLang||isArabic(i.query)?l.name:l.name_en,d="ar"!=GblDefaultLang||isArabic(i.query)?l.store.name:l.store.name_en,u="ar"!=GblDefaultLang||isArabic(i.query)?l.store.tags:l.store.tags_en,h="ar"!=GblDefaultLang||isArabic(i.query)?l.description:l.description_en,f="ar"!=GblDefaultLang||isArabic(i.query)?l.location:l.location_en;t.test(c)||t.test(d)||appModules.filterData.filterSearchkeyWithStoreTags(i.query,u,1)||1==l.options&&null!=f&&t.test(f)?(r.push(l),s=!0):(a.test(c)||o.test(h)||a.test(d)||appModules.filterData.filterSearchkeyWithStoreTags(i.query,u,0)||1==l.options&&null!=f&&a.test(f))&&(n.push(l),s=!0)}),s?$("#refineEvents").removeClass("hidden"):$("#refineEvents").addClass("hidden")},e.filterOnKeywordSearchCategory=function(){""!=i.eventType&&"all"!=i.eventType&&(r=e.filterOnCategory(r),n=e.filterOnCategory(n))},e.filterOnKeywordSearchDate=function(){r=e.filterOnDate(r),n=e.filterOnDate(n)},e.filterOnSearchQuery=function(e){var t=[],a=new RegExp(i.query,"i"),r=i.query.toLowerCase(),n="",o=!1;$.each(e,function(e,i){(a.test(i.name)||a.test(i.description)||a.test(i.store.name)||appModules.filterData.filterSearchkeyWithStoreTags(r,i.store.tags,0)||1==i.options&&null!=i.location&&a.test(i.location))&&(t.push(i),o=!0,""!=$("#search-shop-events").val()&&$("#refineEvents").removeClass("hidden")),o||($("#refineEvents").addClass("hidden"),n=i.name.toLowerCase(),1===$.fn.levenshteinDistance(r,n)&&(p=i.name),p.length<=0&&2===$.fn.levenshteinDistance(r,n)&&(p=i.name),p.length<=0&&3===$.fn.levenshteinDistance(r,n)&&(p=i.name))});var s=$.fn.levenshteinDistance(r,p.toLowerCase());return 0!==s&&4!=s||(p=""),p.length<=0,t},e.filterOnCategory=function(e){var t=[];return""===i.eventType||"all"===i.eventType?e:($.each(e,function(e,a){if(a.targetCategories){var r=!1;$.each(a.targetCategories,function(e,t){if(t.id==i.eventType)return r=!0,!1}),r&&t.push(a)}}),t)},e.filterOnDate=function(e){return e},e.runStoreFilter=function(t){r=[],n=[],""==i.query?($("#matched-events-head").hasClass("hidden")||$("#matched-events-head").addClass("hidden"),$("#all-events-head").removeClass("hidden"),r=e.filterOnSearchQuery(a),r=e.filterOnCategory(r),r=e.filterOnDate(r),e.renderFilteredItems(),e.updateLoadMoreButton()):($("#all-events-head").hasClass("hidden")||$("#all-events-head").addClass("hidden"),$("#matched-events-head").removeClass("hidden"),e.filterOnKeywordSearchQuery(a),e.filterOnKeywordSearchCategory(),e.filterOnKeywordSearchDate(),e.renderFilteredItems(),e.updateLoadMoreButton(),e.updateRelatedEventsLoadMoreButton())},e.renderFilteredItems=function(){$(u).html("");var e=Handlebars.compile(f.html());u.html(e(r.slice(0,t))),$("#events-search-result-container-parent").removeClass("hidden"),$(h).html(""),n.length>0?(h.html(e(n.slice(0,t))),$("#related-events-search-result-container-parent").removeClass("hidden"),0==r.length&&($("#events-search-result-container-parent").hasClass("hidden")||$("#events-search-result-container-parent").addClass("hidden"))):$("#related-events-search-result-container-parent").hasClass("hidden")||$("#related-events-search-result-container-parent").addClass("hidden")},e.updateLoadMoreButton=function(){var e;e=r.length>0?r.length:a.length,r<=0?$("a[data-refinesearch-btn]").hide():$("a[data-refinesearch-btn]").show();var t=u.find(".panel-card:visible").size();d.text("Showing "+t+" of"+e+" Results");var n=d.data("label-showing-indicator");if(0===t){d.hide(),$(".all-offers-seperator").hide();var o=window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result__message").text(o.replace("%SEARCH_TEXT%",i.query)),$(".nosearch-result").removeClass("hidden"),$("#all-events-head").hasClass("hidden")||$("#all-events-head").addClass("hidden"),$("#matched-events-head").hasClass("hidden")||$("#matched-events-head").addClass("hidden")}else $(".all-offers-seperator").show(),$(".nosearch-result").addClass("hidden"),d.show(),n=n.replace("%s1%",t),n=n.replace("%s2%"," "+e),d.text(n);t===e?l.hide():0!==t?l.show():l.hide()},e.updateRelatedEventsLoadMoreButton=function(){var e=0;if(n.length>0&&(e=n.length),0==e&&r.length<=0){$("a[data-refinesearch-btn]").hide();var t=window.MyDeckLocaleData.data.topsearch.noResultMsg;$(".nosearch-result__message").text(t.replace("%SEARCH_TEXT%",i.query)),$(".nosearch-result").removeClass("hidden")}else $("a[data-refinesearch-btn]").show(),$(".nosearch-result").addClass("hidden");var a=h.find(".panel-card:visible").size();a===e?c.hide():0!==a?c.show():c.hide()},e.loadMore=function(i){if("related-events-search-result-container"==i){var o=h.find(".panel-card:visible").size(),s=Handlebars.compile(f.html());n.length>0&&h.append(s(n.slice(o,o+t))),e.updateRelatedEventsLoadMoreButton()}else{var o=u.find(".panel-card:visible").size(),s=Handlebars.compile(f.html());r.length>0?u.append(s(r.slice(o,o+t))):u.append(s(a.slice(o,o+t))),e.updateLoadMoreButton()}},e.init=function(){if(setTimeout(function(){o.focus()},50),l.on("click",function(t){t.preventDefault(),e.loadMore("events-search-result-container")}),c.on("click",function(t){t.preventDefault(),e.loadMore("related-events-search-result-container")}),s.on("click",function(t){t.preventDefault(),o.hideKeyboard(),e.searchButtonEnabled()&&e.runStoreFilter("all")}),$(u).html(getCirclePreloaderTpl(.26)),appModules.storedData.getEvents()){a=appModules.storedData.getEvents();var r=Handlebars.compile(f.html());u.html(r(a.slice(0,t))),e.setFilterById("dateFilter","newest")}else appModules.myDeck.getEvents(function(r,n){a=r,appModules.storedData.setEvents(r);var i=Handlebars.compile(f.html());u.html(i(a.slice(0,t))),e.setFilterById("dateFilter","newest")});s.submit(function(e){e.preventDefault()}),o.on("input",function(t){var a=$(this).val().toLowerCase().trim();a.length?e.enableSearchButton(!0):e.enableSearchButton(!1),e.setFilterById("query",a)}),appModules.selectBoxes.getStyledBoxes().on("select",function(e,t){switch(t.group){case"date-filter":break;case"event-type":}}),appModules.selectBoxes.getStyledBoxes().on("selectionchange",function(t,a){switch(a.group){case"date-filter":e.setFilterById("dateFilter",a.id);break;case"categories":e.setFilterById("eventType",a.id)}}),$(".no-transform.events").on("change",function(t){e.setFilterById("eventType",$(this).val())})},e}(),appModules.pageEventDetail=function(){var e={};return e.init=function(){var e=$(".slick-slider-container").height();$(".map").css({height:e+43})},e}(),appModules.whatsnew=function(){var e={},t=".whatsNewTopPics",a=".whatsNewTopPicsMobile",r=".whatsNewFirstLook",n=[],i=[],o=[];return e.buildFirstLook=function(){if(!i.length)return void $(".section-whatsnew-firstlook").hide();var e=12,t=0,a=Handlebars.compile($("#whatsNewFirstLook-tpl").html());$(r).html(a(i.slice(0,e))),i.length>e?($("a[data-whatsnew-firstlook-show-more]").show(),$("a[data-whatsnew-firstlook-show-more]").click(function(n){n.preventDefault(),t+=e,$(r).append(a(i.slice(t,t+e)));var o=$(r).find(".product-card").length;o>=i.length&&$("a[data-whatsnew-firstlook-show-more]").hide(),$(".product-card-container").each(function(){var e=0;$(".product-card").each(function(){$(this).height()>e&&(e=$(this).height())}),$(".product-card").css("height",e)})})):$("a[data-whatsnew-firstlook-show-more]").hide(),$(".product-card-container").each(function(){var e=0;$(".product-card").each(function(){$(this).height()>e&&(e=$(this).height())}),$(".product-card").css("height",e)})},e.buildNewTopics=function(){var e=30;n=n.slice(0,e),shuffleArray(n);var a=1;$.each(n,function(e,t){if(e%3==0){var r=n.slice(e,3*a);o.push(r),a++}});var r=Handlebars.compile($("#whatsNewTopPicks-tpl").html());$(t).html(r(o)),$(t).slick({autoplay:!0,autoplaySpeed:6e3,arrows:!0,dots:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,rtl:"ar"==GblDefaultLang})},e.buildNewTopicsMobile=function(){var e=0,t=Handlebars.compile($("#whatsNewTopPicksMobile-tpl").html());$(a).html(t(o.slice(0,1))),n.length>3?($("a[data-whatsnew-toppics-show-more]").show(),$("a[data-whatsnew-toppics-show-more]").click(function(r){r.preventDefault(),e+=1,$(a).append(t(o.slice(e,e+1)));var i=3*(e+1);i>=n.length&&$("a[data-whatsnew-toppics-show-more]").hide()})):$("a[data-whatsnew-toppics-show-more]").hide()},e.init=function(){$(r).html(getCirclePreloaderTpl(.26)),$(t).html(getCirclePreloaderTpl(.25)),$(a).html(getCirclePreloaderTpl(.25)),appModules.myDeck.getWhatsNewFirstLook(function(t,a){i=t,e.buildFirstLook()}),appModules.myDeck.getWhatsNewTopPics(function(t,a){n=t,e.buildNewTopics(),e.buildNewTopicsMobile()}),$("a[data-trigger-newsletter-popup]").click(function(){appModules.newsletterPopup.forceShow()});var o,s,l,c,d,u=window.projectConfig.projectSettings.mydeckUrl;appModules.myDeck.getMallInformation(function(e,t){o=e,appModules.storedData.setMallInfo(e),$.each(o.editorials,function(e,t){"whats-new"==t.category&&(l=o.editorials[e].header,c=o.editorials[e].body,whatsNewEditorialCtaText=o.editorials[e].ctaText,whatsNewEditorialCtaLink=o.editorials[e].ctaLink,s=o.editorials[e].picture,d=null!=o.editorials[e].pictureAlt?o.editorials[e].pictureAlt:o.editorials[e].header,$(".whatsNewEditorialTitle").html(l),$(".whatsNewEditorialText").html(c),$(".whatsNewEditorialCta").html(whatsNewEditorialCtaText).attr("href",whatsNewEditorialCtaLink),$(".whatsNewEditorialPic").attr("data-bgset",u+s),$(".whatsNewEditorialPic").attr("data-alt",d))})})},e}(),appModules.shopLanding=function(){var e={},t=".shopLandingCarousel",a=".shopLandingNewestShop",r=".shopLandingOffers",n=".shopLandingNewestProduct",i=[],o=[],s=[],l=[],c=[],d=[];return e.connectToSlickSlider=function(){$(t).slick({autoplay:!0,autoplaySpeed:6e3,centerPadding:"200px",arrows:!1,dots:!0,infinite:!0,fade:!1,slidesToShow:1,slidesToScroll:1,asNavFor:".slick-hero-images",rtl:"ar"==GblDefaultLang})},e.buildLogic=function(){allDines=appModules.filterData.getDineCategoriesForFilter(i),i=appModules.filterData.filterRealStores2(i,allDines),o=shuffle(i),storesWithImages=appModules.filterData.filterHasImages(i),storesWithElevatedImage=appModules.filterData.filterHasElevatedImage(i),shopLandingCarousel=appModules.filterData.getStoresByLevel(storesWithElevatedImage,["gold"],4),d=appModules.filterData.getStoresByLevel(storesWithElevatedImage,["gold"],4);var u=Handlebars.compile($("#shopLandingCarousel-tpl").html());$(t).html(u(d)),e.connectToSlickSlider();var h=Math.floor(Math.random()*shopLandingCarousel.length);shopLandingShop=shopLandingCarousel.slice(h,h+1);var f=Handlebars.compile($("#shopLandingNewestShop-tpl").html());$(a).html(f(shopLandingShop));var p=shuffle(l),g=appModules.filterData.getOffersWithStoreNames(p,i,20);g=appModules.filterData.filterHasImages(g),c=[],g.forEach(function(e){[46,112,126,127].indexOf(e.id)==-1&&c.push(e)});var m=Handlebars.compile($("#shopLandingOffers-tpl").html());$(r).html(m(c.slice(0,3)));var v=appModules.filterData.actual(s),y=appModules.filterData.getProductsWithStoreNames(v,i,v.length),b=appModules.filterData.newest(y,1),w=Handlebars.compile($("#shopLandingNewestProduct-tpl").html());$(n).html(w(b))},e.init3=function(){appModules.myDeck.getProducts(function(t,a){s=t,appModules.storedData.setProducts(t),e.buildLogic()})},e.init2=function(){appModules.storedData.getOffers()?(l=appModules.storedData.getOffers(),e.init3()):appModules.myDeck.getOffers(function(t,a){l=t,appModules.storedData.setOffers(t),e.init3()})},e.init=function(){function o(){clearInterval(g)}$(t).html(getCirclePreloaderTpl(.26)),$(a).html(getCirclePreloaderTpl(.26)),$(r).html(getCirclePreloaderTpl(.26)),$(n).html(getCirclePreloaderTpl(.26));var s,l,c,d,u,h,f=window.projectConfig.projectSettings.mydeckUrl,p=0;appModules.myDeck.getMallInformation(function(e,t){s=e,appModules.storedData.setMallInfo(e),$.each(s.editorials,function(e,t){"shop"==t.category&&null!=t.header&&(l=s.editorials[e].brand,c=s.editorials[e].header,d=s.editorials[e].body,shopEditorialCtaText=s.editorials[e].ctaText,shopEditorialCtaLink=s.editorials[e].ctaLink,u=s.editorials[e].picture,h=null!=s.editorials[e].pictureAlt?s.editorials[e].pictureAlt:s.editorials[e].header,$(".shopEditorialBrand").html(l),$(".shopEditorialTitle").html(c),$(".shopEditorialText").html(d),$(".shopEditorialCta").html(shopEditorialCtaText).attr("href",shopEditorialCtaLink),$(".shopEditorialPic").attr("data-alt",h),$(".shopEditorialPic").attr("data-bgset",f+u))}),p+=1}),appModules.myDeck.getStores(function(e,t){i=e,appModules.storedData.setStores(i),p+=1});var g=setInterval(function(){p>=2&&(e.init2(),o())},500)},e}(),appModules.dineLanding=function(){var e={},t=".dineLandingCarousel",a=".dineLandingNewest",r=".dineLandingOffers",n=".dineLandingNewestProduct",i=[],o=[],s=[],l=[],c=[],d=[];return e.connectToSlickSlider=function(){$(t).slick({autoplay:!0,autoplaySpeed:6e3,centerPadding:"200px",arrows:!1,dots:!0,infinite:!0,fade:!1,slidesToShow:1,slidesToScroll:1,asNavFor:".slick-hero-images",rtl:"ar"==GblDefaultLang})},e.buildLogic=function(){o=shuffle(i),allDines=appModules.filterData.getDineCategoriesForFilter(i),dinesWithImages=appModules.filterData.filterHasImages(allDines),dinesWithElevatedImage=appModules.filterData.filterHasElevatedImage(allDines),s=appModules.filterData.filterHasImages(dinesWithElevatedImage),s=appModules.filterData.getStoresByLevel(s,["gold","silver"],3),c=appModules.filterData.getDineByFlags(dinesWithElevatedImage,3,16),c=appModules.filterData.getStoresByLevel(c,["gold","silver"],3);var u=Handlebars.compile($("#dineLandingCarousel-tpl").html());$(t).html(u(c)),e.connectToSlickSlider();var h=Math.floor(Math.random()*s.length);d=s.slice(h,h+1);var f=Handlebars.compile($("#dineLandingNewest-tpl").html());$(a).html(f(d));var p=appModules.filterData.getOffersWithStoreNames(shuffle(l),allDines,20),g=Handlebars.compile($("#dineLandingOffers-tpl").html());$(r).html(g(p.slice(0,3))),d.length>0&&void 0!=d[0].id?dineLandingSecondaryStore=appModules.filterData.getRandomDineProduct(dinesWithElevatedImage,d[0].id):dineLandingSecondaryStore=[];var m=Handlebars.compile($("#dineLandingNewestProduct-tpl").html());$(n).html(m(dineLandingSecondaryStore))},e.init2=function(){appModules.myDeck.getOffers(function(t,a){l=t,appModules.storedData.setOffers(t),e.buildLogic()})},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),$(a).html(getCirclePreloaderTpl(.26)),$(r).html(getCirclePreloaderTpl(.26)),$(n).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getStores(function(t,a){i=t,appModules.storedData.setStores(t),e.init2()})},e}(),appModules.pageFashionAvenue=function(){var e={},t=".fashion-avenue-new-brands",a=".fashion-avenue-stores",r=[];return e.buildLogic=function(){var e=[],n=[];$.each(r,function(t,a){null!=a.location&&1==a.location.id&&a.flags&FLAG_SPOTLIGHT&&a.flags&FLAG_TOP_PICKS&&e.push(a),null!=a.location&&1==a.location.id&&a.flags&FLAG_SPOTLIGHT&&n.push(a)});var i=Handlebars.compile($("#fashion-avenue-new-brands-tpl").html());e.length>0?$(t).html(i(e.slice(0,3))):($("#fashion-avenue-new-brands-container").hide(),$("#fashion-avenue-new-brands-container-head").hide());var o=Handlebars.compile($("#fashion-avenue-store-tpl").html());n.length>0?$(a).html(o(n.slice(0,3))):$("#fashion-avenue-stores-container").hide(),void 0!==$(".invert_store_logo").html()&&$(".invert_store_logo").invertImages()},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),$(a).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getStores(function(t,a){r=t,appModules.storedData.setStores(t),e.buildLogic()})},e}();var mySpan=$("#70stores"),h3Height=$("#70stores").height(),halfHeight=h3Height/2,windowWidth=$(window).width();mySpan.css({top:-halfHeight,"line-height":"h3Height"});var flag=!0;$("#seeShopsFA, #seeShopsFA2").click(function(e){e.preventDefault(),flag&&(flag=!1,windowWidth<=765?$("html, body").animate({scrollTop:$("#fa-shoplist-results").offset().top},2e3,function(){flag=!0}):$("html, body").animate({scrollTop:$("#fa-shoplist").offset().top},2e3,function(){flag=!0}))}),appModules.pageStay=function(){var e={};return e.init=function(){$(".stayExploreMoreCTA").on("click",function(e){e.preventDefault(),window.open($(this).attr("href"),"_blank")});var e,t,a,r,n,i,o=window.projectConfig.projectSettings.mydeckUrl;appModules.myDeck.getMallInformation(function(s,l){e=s,appModules.storedData.setMallInfo(s),$.each(e.editorials,function(s,l){"stay"==l.category&&(t=e.editorials[s].brand,a=e.editorials[s].header,r=e.editorials[s].body,stayEditorialCtaText=e.editorials[s].ctaText,stayEditorialCtaLink=e.editorials[s].ctaLink,n=e.editorials[s].picture,i=null!=e.editorials[s].pictureAlt?e.editorials[s].pictureAlt:e.editorials[s].header,$(".stayEditorialBrand").html(t),$(".stayEditorialTitle").html(a),$(".stayEditorialText").html(r),$(".stayEditorialCta").html(stayEditorialCtaText).attr("href",stayEditorialCtaLink),$(".stayEditorialPic").attr("data-bgset",o+n),$(".stayEditorialPic").attr("data-alt",i))})})},e}(),appModules.pagePlanYourVisitOpeningsPage=function(){var e={},t=[],a=".planYourVisitOpeningsContainer";return $(document).on("click","a[data-planyourvisit-openingshour]",function(t){$("#extra_tax").remove(),t.preventDefault(),$(".navOpeningHours li").removeClass("active"),$(this).parent().addClass("active"),$(a).html(getCirclePreloaderTpl(.26));var r=$(this).data("id");e.constructOpeningHours(r)}),e.constructOpeningHours=function(e){appModules.myDeck.getMallInformation(function(r,n){if(mallInfo=r,openingInfo=r.openinghours,"en"==GblDefaultLang)var i=["SUN","MON","TUES","WED","THU","FRI","SAT"];else var i=["Ø§Ù„Ø£Ø­Ø¯"," Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†"," Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"," Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"," Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©"," Ø§Ù„Ø³Ø¨Øª"];$.each(openingInfo,function(a){
if(openingInfoId=openingInfo[a].id,openingInfoType=openingInfo[a].type,openingInfoId===e&&0===openingInfoType){thisWeek=$(this)[0].openings;var r=[],n=[];return $.each(thisWeek,function(e){r.push(moment(thisWeek[e].from,["HH,mm"]).locale("en").format("hh:mm")+" "+moment(thisWeek[e].from,["HH,mm"]).locale(GblDefaultLang).format("A")),n.push(moment(thisWeek[e].till,["HH,mm"]).locale("en").format("hh:mm")+" "+moment(thisWeek[e].till,["HH,mm"]).locale(GblDefaultLang).format("A"))}),t=[i,r,n],!1}return openingInfoId===e&&1===openingInfoType?(thisDiscription=$(this)[0].description,""!=thisDiscription&&(thisDiscription=thisDiscription.replace(/\n/g,"<br>")),t=[i,{discription:thisDiscription}],!1):void(t=[])});var o=Handlebars.compile($("#planYourVisitOpenings-tpl").html());$(a).html(o(t)),"2"==e&&$(a).parent().append('<strong id="extra_tax">On weekends certain cafés and restaurants are open for breakfast from 9 AM.</strong>')})},e.init=function(){$(a).html(getCirclePreloaderTpl(.26)),appModules.storedData.getMallInfo()?mallInfo=appModules.storedData.getMallInfo():appModules.myDeck.getMallInformation(function(t,a){mallInfo=t,openingInfo=t.openinghours;var r=$(".navOpeningHours");$.each(openingInfo,function(e,t){null!=t.name&&r.append("<li role='presentation'><a href='#' data-planyourvisit-openingshour='true' data-id="+t.id+">"+t.name+"</a></li>")}),$(".navOpeningHours li").removeClass("active"),$($("a[data-planyourvisit-openingshour]").first()).parent().addClass("active");var n=$("a[data-planyourvisit-openingshour]").first().data("id");e.constructOpeningHours(n)})},e}(),appModules.pagePlanYourVisitGettingHere=function(){var e={},t=".gettingHere-content-metro",a=".gettingHere-content-bus",r=".gettingHere-content-car",n=".gettingHere-content-taxi-careem-uber",i=".gettingHere-content-coach-service",o=[t,a,r,n,i];return e.init=function(){$(".gettingHere-Nav").on("click","li",function(e){e.preventDefault(),$(".gettingHere-Nav li").removeClass("active"),$(this).addClass("active");var t=$(this).attr("data-index");$.each(o,function(e,a){var r=$(a);r.data("index")===t?r.removeClass("hidden"):r.addClass("hidden")})});var t,a,r,n,i,s;appModules.myDeck.getMallInformation(function(o,l){t=o,a=o.gettingThere[0].description,r=o.gettingThere[1].description,n=o.gettingThere[2].description,i=void 0!=o.gettingThere[3]?o.gettingThere[3].description:"",s=void 0!=o.gettingThere[4]?o.gettingThere[4].description:"",appModules.storedData.setMallInfo(o),$(".metroContent").html(r),$(".busContent").html(a),""!=n&&null!=n&&$(".carContent").html(n.replace(new RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),"</br>")),""!=i&&null!=i&&$(".taxi-careem-uber-Content").html(i.replace(new RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),"</br>")),""!=s&&null!=s&&$(".coach-service-Content").html(s.replace(new RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),"</br>")),e.menuHighlight()})},e.menuHighlight=function(){var e=$(".planYourVisitGettingHerePage").data("prefilter");$(".gettingHere-Nav li").each(function(){$(this).data("index")==e&&$(this).trigger("click")}),$("#gettingHere-mobile-Nav li.site-collapse-menu-item").removeClass("active"),$("#gettingHere-mobile-Nav li.site-collapse-menu-item").each(function(){$(this).data("index")==e&&($(this).addClass("active"),$(this).children("div").show())})},e}(),appModules.pagePlanYourVisitServices=function(){var e={};return e.init=function(){var t,a,r,n,i,o,s,l,c,d,u,h,f,p,g,m,v=window.projectConfig.projectSettings.mydeckUrl;appModules.myDeck.getMallInformation(function(y,b){t=y,appModules.storedData.setMallInfo(y),void 0!=t.services&&e.FnConstructServicesContent(t.services),a=t.courtesyPolicy[0].name,r=t.courtesyPolicy[1].name,n=t.courtesyPolicy[2].name,i=t.courtesyPolicy[3].name,o=t.courtesyPolicy[4].name,s=t.courtesyPolicy[0].picture,l=t.courtesyPolicy[1].picture,c=t.courtesyPolicy[2].picture,d=t.courtesyPolicy[3].picture,u=t.courtesyPolicy[4].picture,h=null!=t.courtesyPolicy[0].pictureAlt?t.courtesyPolicy[0].pictureAlt:"The Dubai Mall Courtesy Policy",f=null!=t.courtesyPolicy[1].pictureAlt?t.courtesyPolicy[1].pictureAlt:"The Dubai Mall Courtesy Policy",p=null!=t.courtesyPolicy[2].pictureAlt?t.courtesyPolicy[2].pictureAlt:"The Dubai Mall Courtesy Policy",g=null!=t.courtesyPolicy[3].pictureAlt?t.courtesyPolicy[3].pictureAlt:"The Dubai Mall Courtesy Policy",m=null!=t.courtesyPolicy[4].pictureAlt?t.courtesyPolicy[4].pictureAlt:"The Dubai Mall Courtesy Policy",$(".courtesy1").html(a),$(".courtesy2").html(r),$(".courtesy3").html(n),$(".courtesy4").html(i),$(".courtesy5").html(o),$(".courtesyPic1").attr({src:v+s,alt:h}),$(".courtesyPic2").attr({src:v+l,alt:f}),$(".courtesyPic3").attr({src:v+c,alt:p}),$(".courtesyPic4").attr({src:v+d,alt:g}),$(".courtesyPic5").attr({src:v+u,alt:m})})},e.FnConstructServicesContent=function(e){$("#plan-services-desc").html(e.description.replace("\n","</br></br>"));var t=[];$.each(e.services,function(){if(null!=this.name&&null!=this.description){var e={};e.name=this.name,e.description=this.description.split("\n"),t.push(e)}});var a=Handlebars.compile($("#plan-your-visit-services-content").html());$("#plan-services-content").html(a(t))},e}(),appModules.showVideo=function(){var e={};return e.init=function(){$("#playBtn").on("click",function(e){e.preventDefault(),$("#playBtn").addClass("hidden"),$("#videoTitle").addClass("hidden"),$("#videoPlayer").removeClass("hidden");var t=$("#videoPlayer").data("mcvideo");if(t.indexOf("youtu")>=0){var a=t.split("/"),r=a.slice(-1)[0];r.indexOf("watch?v=")>=0&&(r=r.replace("watch?v=","")),$("#videoPlayer").attr("src","https://www.youtube.com/embed/"+r+"?autoplay=1&rel=0")}else if(t.indexOf("vimeo")>=0){var a=t.split("/"),r=a.slice(-1)[0];$("#videoPlayer").attr("src","https://player.vimeo.com/video/"+r+"?title=0&byline=0&badge=0&autoplay=1")}})},e}(),appModules.mapHeight=function(){var e={};return e.init=function(){var e=$(".bronze-detail").height();$(".bronze-map iframe#michello-map").length>0?$(".bronze-map").css("height",e+55):$(".bronze-map").css("height",e)},e}(),appModules.pageFitness=function(){var e={};return e.init=function(){$("#classes").change(function(){var t=$("#classes").val();if(""!=t){var a=window.projectConfig.projectSettings.fitnessClasses;$.each(a,function(a,r){if(a==t){var n="";n+='<option value=""> - Select Here - </option>';for(var a=0;a<r.length;a++)e.checkValidClassTiming(r[a])&&(n+='<option value="'+r[a]+'">'+r[a]+"</option>");$("#timing").html(n)}})}else{var r='<option value=""> - Select Here - </option>';$("#timing").html(r)}}),jQuery.validator.addMethod("alphabetsAndSpacesOnly",function(e,t){return this.optional(t)||/^[a-zA-Z\s]+$/.test(e)}),jQuery.validator.addMethod("alphabetsNumbersAndSpacesOnly",function(e,t){return this.optional(t)||/^[a-zA-Z0-9\s]+$/.test(e)}),jQuery.validator.addMethod("tenDigitsOnly",function(e,t){return this.optional(t)||/^[0-9]{10}$/.test(e)}),jQuery.validator.addMethod("dobValidation",function(e,t){if(""==$("#dob_day").val()&&""==$("#dob_month").val()&&""==$("#dob_year").val())return!0;var a=""!=$("#dob_day").val()?$("#dob_day").val():0,r=""!=$("#dob_month").val()?$("#dob_month").val():0,n=""!=$("#dob_year").val()?$("#dob_year").val():0,i=r+"/"+a+"/"+n,o=/^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,s=i.match(o);if(null==s)return!1;if(dtMonth=s[1],dtDay=s[3],dtYear=s[5],dtMonth<1||dtMonth>12)return!1;if(dtDay<1||dtDay>31)return!1;if((4==dtMonth||6==dtMonth||9==dtMonth||11==dtMonth)&&31==dtDay)return!1;if(2==dtMonth){var l=dtYear%4==0&&(dtYear%100!=0||dtYear%400==0);if(dtDay>29||29==dtDay&&!l)return!1}return!0}),$("#signupForm").validate({rules:{first_name:{required:!0,alphabetsAndSpacesOnly:!0},last_name:{alphabetsAndSpacesOnly:!0},dob_year:{dobValidation:!0},classes:"required",timing:{required:!0,remote:{url:"/fitness-class-validate",type:"post",async:"false",dataType:"json",data:{timing:function(){return $("#timing").val()},"class":function(){return $("#classes").val()}},dataFilter:function(e){var t=$.parseJSON(e);return void 0!=t.message&&"Success"==t.message}}},mobile:{required:!0,digits:!0,tenDigitsOnly:!0},email:{required:!0,email:!0,remote:{url:"/fitness-email-validate",type:"post",async:"false",dataType:"json",data:{email:function(){return $("#email").val()}},dataFilter:function(e){var t=$.parseJSON(e);return void 0!=t.message&&"Success"==t.message}}},medical:{alphabetsNumbersAndSpacesOnly:!0},agree:"required"},messages:{first_name:{required:window.MyDeckLocaleData.data.fitnessPage.requiredMsg,alphabetsAndSpacesOnly:window.MyDeckLocaleData.data.fitnessPage.alphabetsSpaceMsg},last_name:{alphabetsAndSpacesOnly:window.MyDeckLocaleData.data.fitnessPage.alphabetsSpaceMsg},dob_year:{dobValidation:window.MyDeckLocaleData.data.fitnessPage.validDOBMsg},classes:window.MyDeckLocaleData.data.fitnessPage.requiredMsg,timing:{required:window.MyDeckLocaleData.data.fitnessPage.requiredMsg,remote:window.MyDeckLocaleData.data.fitnessPage.seatAllocationMsg},mobile:{required:window.MyDeckLocaleData.data.fitnessPage.requiredMsg,digits:window.MyDeckLocaleData.data.fitnessPage.numbersOnlyMsg,tenDigitsOnly:window.MyDeckLocaleData.data.fitnessPage.digitsRestrictionMsg},email:{required:window.MyDeckLocaleData.data.fitnessPage.requiredMsg,email:window.MyDeckLocaleData.data.fitnessPage.validEmailMsg,remote:window.MyDeckLocaleData.data.fitnessPage.emailRestrictionMsg},medical:{alphabetsNumbersAndSpacesOnly:window.MyDeckLocaleData.data.fitnessPage.alphabetsSpaceDigitsMsg},agree:window.MyDeckLocaleData.data.fitnessPage.requiredMsg},errorPlacement:function(e,t){"gender"==t.attr("name")?e.insertAfter("#gendererror"):"agree"==t.attr("name")?e.insertAfter("#agreeerror"):"dob_day"==t.attr("name")||"dob_month"==t.attr("name")||"dob_year"==t.attr("name")?e.insertAfter("#doberror"):e.insertAfter(t)}})},e.checkValidClassTiming=function(e){var t=e.split(" - "),a=t[0].split(" "),r=t[1].split(" to "),n=new Date,i=n.getFullYear(),o=new Date(a[0]+" "+a[1]+" "+i).getTime()+60*Math.ceil(r[1])*60*1e3,s=(new Date).getTime();return o>=s},e.checkValidDOB=function(){if(""==$("#dob_day").val()&&""==$("#dob_month").val()&&""==$("#dob_year").val())return!0;var e=""!=$("#dob_day").val()?$("#dob_day").val():0,t=""!=$("#dob_month").val()?$("#dob_month").val():0,a=""!=$("#dob_year").val()?$("#dob_year").val():0,r=t+"/"+e+"/"+a,n=/^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,i=r.match(n);if(null==i)return!1;if(dtMonth=i[1],dtDay=i[3],dtYear=i[5],dtMonth<1||dtMonth>12)return!1;if(dtDay<1||dtDay>31)return!1;if((4==dtMonth||6==dtMonth||9==dtMonth||11==dtMonth)&&31==dtDay)return!1;if(2==dtMonth){var o=dtYear%4==0&&(dtYear%100!=0||dtYear%400==0);if(dtDay>29||29==dtDay&&!o)return!1}return!0},e}(),appModules.pageUByEmaar=function(){var e={},t=".timetocelebrate-content",a=".summeroffer-content",r=[t,a];return e.init=function(){$(".UByEmaar-Nav").on("click","li",function(e){e.preventDefault(),$(".UByEmaar-Nav li").removeClass("active"),$(this).addClass("active");var t=$(this).attr("data-index");$.each(r,function(e,a){var r=$(a);r.data("index")===t?r.removeClass("hidden"):r.addClass("hidden")})})},e}(),appModules.showHomeCarousel=function(){var e,t,a={},r=".homeCarousel",n=[],i=[];return a.connectToSlickSlider=function(){$(r).slick({autoplay:!0,autoplaySpeed:6e3,centerPadding:"200px",arrows:!1,dots:!0,infinite:!0,fade:!1,slidesToShow:1,slidesToScroll:1,asNavFor:".slick-hero-images",rtl:"ar"==GblDefaultLang})},a.buildLogic=function(){var o=[];o.from=e;var s=[];s.until=t,n=[i,o,s];var l=Handlebars.compile($("#homeCarousel-tpl").html()),c=i.length;0===c&&a.init(),$(r).html(l(n)),a.connectToSlickSlider()},a.init=function(){function n(){clearInterval(o)}$(r).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getMallInformation(function(a,r){if(mallInfo=a,void 0!=a.openinghours&&($.each(a.openinghours,function(e,t){1==t.id&&(dayInfo=a.openinghours[e].openings)}),$.each(dayInfo,function(a){dayInfo[a].day===currentDay&&(e=moment($(this)[0].from,["HH:mm"]).locale("en").format("hh")+" "+moment($(this)[0].from,["HH:mm"]).locale(GblDefaultLang).format("a"),t=moment($(this)[0].till,["HH:mm"]).locale("en").format("hh")+" "+moment($(this)[0].till,["HH:mm"]).locale(GblDefaultLang).format("a"))})),void 0!=a.info&&void 0!=a.info.carousel){var n=a.info.carousel;$.each(n,function(e,t){null!=t.header&&i.push(t)})}appModules.storedData.setMallInfo(a)});var o=setInterval(function(){"undefined"!==e&&"undefined"!==i&&0!=i.length&&(a.buildLogic(),n())},500)},a}(),appModules.sliderDontMiss=function(){var e={},t=[],a=[],r=".slick-dont-miss-slider",n=10;return e.connectToSlickSlider=function(){$(r).slick({dots:!0,arrows:!1,infinite:!0,autoplay:!0,autoplaySpeed:2500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:922,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}],rtl:"ar"==GblDefaultLang})},e.buildLogic=function(){$(r).on("click","figure",function(e){e.preventDefault(),location.href=$(this).data("link")});var i=$(r).data("prefilter");i&&i.excludeShopFilter&&(t=appModules.filterData.filterExcludeEventOrOfferByCategory(t,i.excludeShopFilter)),t.sort(function(){return.5-Math.random()});for(var o=[],s=[],l=0,c=t.length;l<c;l++){var d=t[l];"event"==d.type&&o.push(d),"offer"==d.type&&s.push(d)}for(var c=t.length,u=0,h=0,l=0;l<c;l++)l%2===0?(o[u]&&(o[u]["event-type"]="event-detail",a.push(o[u])),u++):(s[h]&&(s[h]["event-type"]="offer-detail",a.push(s[h])),h++);a=a.slice(0,n);var f=Handlebars.compile($("#slider-dont-miss-out-tpl").html());$(r).html(f(a)),e.connectToSlickSlider()},e.init=function(){$(r).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getWhatsNewDontMiss(function(a,r){t=a,e.buildLogic()})},e}(),appModules.showFeaturedStores=function(){var e,t={},a=".section-featured-shops",r=".featured-stores-for-tablets",n=[];return t.connectToSlickSlider=function(){$(a).slick({dots:!1,arrows:!0,infinite:!0,slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:922,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:766,settings:{slidesToShow:1,slidesToScroll:1}}],rtl:"ar"==GblDefaultLang})},t.renderTemplate=function(){var n=appModules.filterData.filterHasElevatedImage(e),i=t.filterFeaturedStores(n),o=t.randomizeStores(i),s=appModules.filterData.getStoresByLevel(o,["gold","silver"],3),l=Handlebars.compile($("#slider-featured-stores-tpl").html());$(a).html(l(s)),$(r).html(l(s)),t.connectToSlickSlider()},t.filterFeaturedStores=function(e){var t=[];return $.each(e,function(e,a){a.flags&FLAG_FEATURED&&$.inArray(a.id,n)==-1&&(n.push(a.id),t.push(a))}),t},t.randomizeStores=function(e){return e.length>1?e=e.sort(function(){return.5-Math.random()}):e},t.init=function(){$(a).html(getCirclePreloaderTpl(.26));var r=!1;$(a).data("filter-dine")&&(r=$(a).data("filter-dine")),appModules.storedData.getStores()?(e=appModules.storedData.getStores(),r&&(e=appModules.filterData.getDineCategoriesForFilter(e)),t.renderTemplate()):appModules.myDeck.getStores(function(a){e=r?appModules.filterData.getDineCategoriesForFilter(a):appModules.filterData.getNonDineCategoriesForFilter(a),appModules.storedData.setStores(e),t.renderTemplate()})},t}(),appModules.eventFeaturedCarousel=function(){var e={},t=".eventFeaturedCarousel";return e.connectToSlickSlider=function(){$(t).slick({arrows:!1,dots:!1,infinite:!0,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:767,settings:{slidesToShow:1}}],rtl:"ar"==GblDefaultLang})},e.buildLogic=function(){$(t).on("click","figure",function(e){e.preventDefault(),location.href=$(this).data("link")});var a=[];$.each(eventFeaturedCarousel,function(e,t){t.flags&FLAG_FEATURED&&a.push(t)});appModules.storedData.getStores();if(a.length>0){var r=Handlebars.compile($("#eventFeaturedCarousel-tpl").html());$(t).html(r(a)),e.connectToSlickSlider()}else $("section.featured").addClass("hidden")},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getStores(function(e,t){allStoresData=e}),appModules.myDeck.getEvents(function(t,a){eventFeaturedCarousel=t,appModules.storedData.setEvents(t),e.buildLogic()})},e}(),appModules.sliderOffers=function(){var e,t={},a=".slick-offers-slider";return t.connectToSlickSlider=function(){$(a).slick({dots:!0,arrows:!1,infinite:!0,fade:"false",slidesToShow:1,slidesToScroll:1})},t.renderTemplate=function(){e.sort(function(){return.5-Math.random()});var r=Handlebars.compile($("#slider-offers-detail-tpl").html());$(a).html(r(e)),t.connectToSlickSlider()},t.init=function(){$(a).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getOffers(function(a,r){e=a,appModules.storedData.setOffers(a),t.renderTemplate()})},t}(),appModules.sliderOffersAndEvents=function(){var e,t,a={},r=[],n=".slick-events-offers-slider",i=10;return a.connectToSlickSlider=function(){$(n).slick({dots:!0,arrows:!0,infinite:!0,autoplay:!0,autoplaySpeed:2500,slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:922,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1,dots:!1}}],rtl:"ar"==GblDefaultLang})},a.buildLogic=function(){$(n).on("click","figure",function(e){e.preventDefault(),location.href=$(this).data("link")});var o=$(n).data("prefilter");o&&o.excludeShopFilter&&(t=appModules.filterData.filterExcludeEventOrOfferByCategory(t,o.excludeShopFilter),e=appModules.filterData.filterExcludeEventOrOfferByCategory(e,o.excludeShopFilter));var s=[];$.each(e,function(e,t){t.flags&FLAG_DON_T_MISS&&(t["event-type"]="offer-detail",s.push(t))});var l=[];$.each(t,function(e,t){t.flags&FLAG_DON_T_MISS&&(t["event-type"]="event-detail",l.push(t))}),l.sort(function(){return.5-Math.random()}),s.sort(function(){return.5-Math.random()}),r=s.concat(l),r.sort(function(){return.5-Math.random()}),r=r.slice(0,i);var c=Handlebars.compile($("#slider-offers-and-events-tpl").html());$(n).html(c(r)),a.connectToSlickSlider()},a.init=function(){function r(){clearInterval(i)}$(n).html(getCirclePreloaderTpl(.26)),appModules.storedData.getOffers()?e=appModules.storedData.getOffers():appModules.myDeck.getOffers(function(t,a){e=t,appModules.storedData.setOffers(t)}),appModules.storedData.getEvents()?t=appModules.storedData.getEvents():appModules.myDeck.getEvents(function(e,a){t=e,appModules.storedData.setEvents(e)});var i=setInterval(function(){void 0!=e&&void 0!=t&&(0!=e.length&&0!=t.length?(a.buildLogic(),r()):$(n).html(""))},500)},a}(),appModules.youAlsoMayLikeOffers=function(){var e={},t=[],a=".section-you-also-may-like";return e.connectToSlickSlider=function(){$(a).slick({dots:!1,arrows:!0,infinite:!0,slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:922,settings:{slidesToShow:2,slidedToScroll:2}},{breakpoint:766,settings:{slidesToShow:1,slidesToScroll:1}}],rtl:"ar"==GblDefaultLang})},e.renderTemplate=function(){var r=Handlebars.compile($("#slider-offers-you-may-like-tpl").html());$(a).html(r(t)),e.connectToSlickSlider()},e.init=function(){function r(){clearInterval(n)}$(a).html(getCirclePreloaderTpl(.26)),appModules.storedData.getOffers()?t=appModules.storedData.getOffers():appModules.myDeck.getOffers(function(e,a){t=e,appModules.storedData.setOffers(e)});var n=setInterval(function(){0!=t.length&&(e.renderTemplate(),r())},500)},e}(),appModules.offerFeaturedCarousel=function(){var e={},t=".offerFeaturedCarousel";return e.connectToSlickSlider=function(){$(t).slick({arrows:!1,dots:!1,infinite:!0,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:767,settings:{slidesToShow:1}}],rtl:"ar"==GblDefaultLang})},e.buildLogic=function(){$(t).on("click","figure",function(e){e.preventDefault(),location.href=$(this).data("link")});var a=[];if($.each(offerFeaturedCarousel,function(e,t){t.flags&FLAG_FEATURED&&a.push(t)}),a.length>0){var r=Handlebars.compile($("#featuredCarousel-tpl").html());$(t).html(r(a)),e.connectToSlickSlider()}else $("section.featured").addClass("hidden")},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getOffers(function(t,a){offerFeaturedCarousel=t,appModules.storedData.setOffers(t),e.buildLogic()})},e}(),appModules.stayOffer=function(){var e={},t=".stayOfferCarousel",a=[],r=[],n=[];return e.connectToSlickSlider=function(){$(t).slick({arrows:!0,dots:!0,infinite:!0,slidesToShow:1,slidesToScroll:1,rtl:"ar"==GblDefaultLang})},e.filterHotelOffers=function(){var e=appModules.filterData.getHotelsFromStores(n);$.each(a,function(t,a){$.each(e,function(e,t){a.storeId==t.id&&r.push(a)})}),r.length<=0&&$(t).hide()},e.buildLogic=function(){appModules.myDeck.getStores(function(t,a){n=t,e.filterHotelOffers(),e.renderCarousel()})},e.renderCarousel=function(){var a=Handlebars.compile($("#stayOfferCarousel-tpl").html());$(t).html(a(r)),e.connectToSlickSlider()},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.myDeck.getOffers(function(t,r){a=t,appModules.storedData.setOffers(t),e.buildLogic()})},e}();var itemsToShow=9,relatedshop_itemsToShow=9,countShop=0,ArrMainSrchAllShops=[],ArrMainSrchExactShops=[],ArrMainSrchRelatedShops=[],parsleyValidator={},reg=/<\w+>|<\/\w+>/gi,var1="<label>sfsdf</label>";appModules.searchShops=function(){var e={},t="#filteredShop",a=[];return e.buildLogic=function(){var e=[];$.each(a,function(t,a){e.push(a)}),ArrMainSrchAllShops=e;var r=Handlebars.compile($("#store-search-item-tpl").html());$(t).html(r(e))},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.storedData.getStores()?(a=appModules.storedData.getStores(),e.buildLogic()):appModules.myDeck.getStores(function(t,r){appModules.storedData.setStores(t),a=t,e.buildLogic()})},e}(),appModules.searchShops2=function(){var e={},t="#filteredShop",a=[];return e.buildLogic=function(){var e=[],r=window.location.href.split("/");"shop"===r[r.length-1]?$.each(a,function(t,a){""!=a.categories&&$.each(a.categories,function(t,r){if(1==r.type)return e.push(a),!1})}):"dine"===r[r.length-1]&&$.each(a,function(t,a){""!=a.categories&&$.each(a.categories,function(t,r){if(5==r.type)return e.push(a),!1})});var n=Handlebars.compile($("#store-search-item-tpl").html());$(t).html(n(e))},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.storedData.getStores()?(a=appModules.storedData.getStores(),e.buildLogic()):appModules.myDeck.getStores(function(t,r){appModules.storedData.setStores(t),a=t,e.buildLogic()})},e}();var ArrMainSrchAllEvents=[],ArrMainSrchExactEvents=[],ArrMainSrchRelatedEvents=[];appModules.searchEvents=function(){var e={},t="#filteredEvent",a=[];return e.buildLogic=function(){var e=[];$.each(a,function(t,a){e.push(a)}),ArrMainSrchAllEvents=e},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.storedData.getEvents()?(a=appModules.storedData.getEvents(),e.buildLogic()):appModules.myDeck.getEvents(function(t,r){appModules.storedData.setEvents(t),a=t,e.buildLogic()})},e}();var count1,count2,count3,ArrMainSrchAllOffers=[],ArrMainSrchExactOffers=[],ArrMainSrchRelatedOffers=[];appModules.searchOffers=function(){var e={},t="#filteredOffer",a=[];return e.buildLogic=function(){var e=[];$.each(a,function(t,a){e.push(a)}),ArrMainSrchAllOffers=e},e.init=function(){$(t).html(getCirclePreloaderTpl(.26)),appModules.storedData.getOffers()?(a=appModules.storedData.getOffers(),e.buildLogic()):appModules.myDeck.getOffers(function(t,r){appModules.storedData.setOffers(t),a=t,e.buildLogic()})},e}(),appModules.mainSearch=function(){var e={};return e.init=function(){function e(){if($("#filteredShop:first .list").removeClass("hidden3"),itemsToShow=9,relatedshop_itemsToShow=9,""!=$("#q").val()){$("#q").val().toLowerCase()}else;count1=0,count2=0,count3=0;var e=$("#q").val().trim();if(u=[],$(".global-search--help-result").html(""),!e.replace(/^\s+/,""))return $("#q").val(""),"none"===$(".top-searches").css("display")&&($(".search-section").css("display","none"),$(".search-input").css("display","block"),$(".top-searches").css("display","block")),!1;$(".search-submit").trigger("click");var n=window.MyDeckLocaleData.data.topsearch.showResultMsg;$("#yourSearch").html(n.replace("%SEARCH_TEXT%",e)),$(".shop-search-result").empty(),t(),a(),r();var i=parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)+parseInt(count2)+parseInt(count3);if($("#srch_count_all").text(i),$("#srch_count_shop").text(parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)),$("#srch_count_offer").text(count2),$("#srch_count_event").text(count3),o=!1,0==i){var s=window.MyDeckLocaleData.data.topsearch.noResultMsg;$("#yourSearch").html(s.replace("%SEARCH_TEXT%",e)),$("#main-top-srch-refine-srch").hasClass("hidden")||$("#main-top-srch-refine-srch").addClass("hidden"),$("#main-top-srch-srch-again").removeClass("hidden"),$("#search-shop-category").attr("disabled","disabled")}else $("#main-top-srch-srch-again").hasClass("hidden")||$("#main-top-srch-srch-again").addClass("hidden"),$("#main-top-srch-refine-srch").removeClass("hidden"),parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)==0?$("#search-shop-category").attr("disabled","disabled"):$("#search-shop-category").removeAttr("disabled");alignElements()}function t(){$("#filteredShop:first .list").addClass("hidden");var e=0;ArrMainSrchExactShops=[],ArrMainSrchRelatedShops=[];var t=$("#q").val().toLowerCase().trim(),a=new RegExp("^"+t+"$","i"),r=new RegExp(t,"i"),n=new RegExp("\\b"+t+"\\b","i");$("#filteredShop-parent").removeClass("hidden"),$.each(ArrMainSrchAllShops,function(i,o){var s="ar"!=GblDefaultLang||isArabic(t)?o.name:o.name_en,l="ar"!=GblDefaultLang||isArabic(t)?o.description:o.description_en,c="ar"!=GblDefaultLang||isArabic(t)?o.tags:o.tags_en;a.test(s)||appModules.filterData.filterSearchkeyWithStoreTags(t,c,1)?(ArrMainSrchExactShops.push(o),$("#filteredShop #main-top-srch-shop-"+o.id).removeClass("hidden"),count1++,e>=itemsToShow&&$("#filteredShop #main-top-srch-shop-"+o.id).addClass("hidden3"),e++,itemsToShow>=count1?$("#showMore").hide():$("#showMore").show(),countShop=count1):r.test(s)||n.test(l)||appModules.filterData.filterSearchkeyWithStoreTags(t,c,0)?(ArrMainSrchRelatedShops.push(o),$("#filteredShop #main-top-srch-shop-"+o.id).addClass("hidden")):$("#filteredShop #main-top-srch-shop-"+o.id).addClass("hidden")}),FnManageRelatedSearchShops()}function a(){ArrMainSrchExactOffers=[],ArrMainSrchRelatedOffers=[];var e=$("#q").val().toLowerCase().trim(),t=new RegExp("^"+e+"$","i"),a=new RegExp(e,"i"),r=new RegExp("\\b"+e+"\\b","i");if($("#filteredOffer-parent").removeClass("hidden"),$.each(ArrMainSrchAllOffers,function(n,i){var o="ar"!=GblDefaultLang||isArabic(e)?i.name:i.name_en,s="ar"!=GblDefaultLang||isArabic(e)?i.store.name:i.store.name_en,l="ar"!=GblDefaultLang||isArabic(e)?i.store.tags:i.store.tags_en,c="ar"!=GblDefaultLang||isArabic(e)?i.description:i.description_en,d="ar"!=GblDefaultLang||isArabic(e)?i.location:i.location_en;t.test(o)||t.test(s)||appModules.filterData.filterSearchkeyWithStoreTags(e,l,1)||1==i.options&&t.test(d)?(ArrMainSrchExactOffers.push(i),count2++):(a.test(o)||r.test(c)||a.test(s)||appModules.filterData.filterSearchkeyWithStoreTags(e,l,0)||1==i.options&&a.test(d))&&(ArrMainSrchRelatedOffers.push(i),count2++)}),$("#filteredOffer").html(""),ArrMainSrchExactOffers.length>0||ArrMainSrchRelatedOffers.length>0){var n=Handlebars.compile($("#offer-search-item-tpl").html());ArrMainSrchExactOffers.length>0&&($("#filteredOffer").html(n(ArrMainSrchExactOffers.slice(0,3))),$("#filteredOffer:first .list").removeClass("hidden"),ArrMainSrchExactOffers.length>3?$("#offershowMore").show():$("#offershowMore").hide()),$("#related-filteredOffer").html(""),ArrMainSrchRelatedOffers.length>0?($("#related-filteredOffer").html(n(ArrMainSrchRelatedOffers.slice(0,3))),$("#related-filteredOffer:first .list").removeClass("hidden"),$("#related-filteredOffer-parent").removeClass("hidden"),ArrMainSrchRelatedOffers.length>3?$("#related-offershowMore").show():$("#related-offershowMore").hide(),0==ArrMainSrchExactOffers.length&&($("#filteredOffer-parent").hasClass("hidden")||$("#filteredOffer-parent").addClass("hidden"))):$("#related-filteredOffer-parent").hasClass("hidden")||$("#related-filteredOffer-parent").addClass("hidden")}else $("#filteredOffer-parent").hasClass("hidden")||$("#filteredOffer-parent").addClass("hidden"),$("#related-filteredOffer-parent").hasClass("hidden")||$("#related-filteredOffer-parent").addClass("hidden")}function r(){ArrMainSrchExactEvents=[],ArrMainSrchRelatedEvents=[];var e=$("#q").val().toLowerCase().trim(),t=new RegExp("^"+e+"$","i"),a=new RegExp(e,"i"),r=new RegExp("\\b"+e+"\\b","i");if($("#filteredEvent-parent").removeClass("hidden"),$.each(ArrMainSrchAllEvents,function(n,i){var o="ar"!=GblDefaultLang||isArabic(e)?i.name:i.name_en,s="ar"!=GblDefaultLang||isArabic(e)?i.store.name:i.store.name_en,l="ar"!=GblDefaultLang||isArabic(e)?i.store.tags:i.store.tags_en,c="ar"!=GblDefaultLang||isArabic(e)?i.description:i.description_en,d="ar"!=GblDefaultLang||isArabic(e)?i.location:i.location_en;t.test(o)||t.test(s)||appModules.filterData.filterSearchkeyWithStoreTags(e,l,1)||1==i.options&&t.test(d)?(ArrMainSrchExactEvents.push(i),count3++):(a.test(o)||r.test(c)||a.test(s)||appModules.filterData.filterSearchkeyWithStoreTags(e,l,0)||1==i.options&&a.test(d))&&(ArrMainSrchRelatedEvents.push(i),count3++)}),$("#filteredEvent").html(""),ArrMainSrchExactEvents.length>0||ArrMainSrchRelatedEvents.length>0){var n=Handlebars.compile($("#event-search-item-tpl").html());ArrMainSrchExactEvents.length>0&&($("#filteredEvent").html(n(ArrMainSrchExactEvents.slice(0,3))),$("#filteredEvent:first .list").removeClass("hidden"),ArrMainSrchExactEvents.length>3?$("#eventshowMore").show():$("#eventshowMore").hide()),$("#related-filteredEvent").html(""),ArrMainSrchRelatedEvents.length>0?($("#related-filteredEvent").html(n(ArrMainSrchRelatedEvents.slice(0,3))),$("#related-filteredEvent:first .list").removeClass("hidden"),$("#related-filteredEvent-parent").removeClass("hidden"),ArrMainSrchRelatedEvents.length>3?$("#related-eventshowMore").show():$("#related-eventshowMore").hide(),0==ArrMainSrchExactEvents.length&&($("#filteredEvent-parent").hasClass("hidden")||$("#filteredEvent-parent").addClass("hidden"))):$("#related-filteredEvent-parent").hasClass("hidden")||$("#related-filteredEvent-parent").addClass("hidden")}else $("#filteredEvent-parent").hasClass("hidden")||$("#filteredEvent-parent").addClass("hidden"),$("#related-filteredEvent-parent").hasClass("hidden")||$("#related-filteredEvent-parent").addClass("hidden")}function n(e,t){$(e).val($(t.target).text()),$(e).trigger("keyup"),$(".shop-search-result").empty(),$(e).focus()}function i(e,t){$(e).val($(t.target).text()),$(e).trigger("keyup"),$(e).focus(),$(".global-search--help-result").css("display","none")}var o=!1;$(".site-search-btn").on("click",function(e){$("#filteredShop:first .list").addClass("hidden"),$("#filteredOffer:first .list").addClass("hidden"),$("#filteredEvent:first .list").addClass("hidden"),$("#q").val(""),$(".global-search--help-result").empty()}),parsleyValidator=$("#search2").parsley(),$("#shop-search2").on("click",function(e){e.preventDefault();var t=$("#q2").val();return t.match(reg)?("en"==GblDefaultLang?$("#search2 fieldset ").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; left:0px">Invalid Input! </div>'):$("#search2 fieldset ").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; right:0px">Invalid Input! </div>'),void window.setTimeout(function(){$(".added_search").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},4e3)):(appModules.searchShops2.init(),$(".site-search-btn").trigger("click"),$("#q").val($("#q2").val()),$("#q2").val(""),o=!1,$(".search-submit").trigger("click"),$("#q").keyup(),!1)}),$("#icon-search-topSearch").on("click",function(e){return e.preventDefault(),$("#search-shop-category").val(""),$("#filteredShop:first .list").removeClass("hidden2"),$("#q").keyup(),!1}),$(".shop-search-result").on("click",function(e){n("#q",e)}),$(".shop-search-result2").on("click",function(e){n("#q2",e),$(".shop-search-result2").empty()}),$(".global-search--help-result").on("click",function(e){
i("#q",e)});var s,l,c,d,u=[],h=window.location.href.split("/"),f=[56,71,65,62,77,68,149,206,209],p=[];appModules.myDeck.getStores(function(e){mainsearchrenderCategories(e),appModules.storedData.setStores(e),appModules.searchShops.init(),appModules.myDeck.getOffers(function(t){appModules.storedData.setOffers(t),appModules.searchOffers.init(),appModules.myDeck.getEvents(function(a){appModules.storedData.setEvents(a),appModules.searchEvents.init(),l=$.merge(a,t),p=$.merge(l,e)})})}),"shop"===h[h.length-1]&&appModules.myDeck.getStores(function(e,t){s=e,c=appModules.filterData.filterExcludeStoreByCategory(s,f)}),"dine"===h[h.length-1]&&appModules.myDeck.getStores(function(e,t){s=e,d=appModules.filterData.getDineCategoriesForFilter(s)}),$("#q").keypress(function(e){if(13==e.which&&""===$(this).val())return $("#q").val(""),!1});$("#q").bind("input propertychange",function(t){var a=$(this).val();if(a.match(reg))"en"==GblDefaultLang?$(".search-section.search-input div form").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; left:0px">Invalid Input!  </div>'):$(".search-section.search-input div form").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; right:0px">Invalid Input! </div>'),window.setTimeout(function(){$(".added_search").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},4e3);else{if(navigator.userAgent.indexOf("Android")>-1){var r=$(".site-search-drop");r.css("position","absolute")}var n=$.trim($("#search-shop-category").val());""!==n&&($("#search-shop-category").val(""),$("#search-shop-category").trigger("change"));var i=setInterval(function(){$(".top-searches").css("display","none"),0!=p.length?(clearInterval(i),$(".search-preloading #search-results-preloading").html(""),$(".search-preloading").hide(),e()):($(".search-preloading").show(),$(".search-preloading #search-results-preloading").html(getCirclePreloaderTpl(.26)),console.log("waiting for allItems variable to be set"))},500)}}),$("#q").on("keyup",function(t){t.preventDefault();var a=$(this).val();if(a.match(reg))"en"==GblDefaultLang?$(".search-section.search-input div form").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; left:0px">Invalid Input! </div>'):$(".search-section.search-input div form").append('<div class=" added_search parsley-errors-list filled text-danger" style="position: absolute; width:100%; right:0px">Invalid Input! </div>'),window.setTimeout(function(){$(".added_search").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},4e3);else{if($(".drop-category #shop-category2 option").prop("selected",function(){return this.defaultSelected}),navigator.userAgent.indexOf("Android")>-1){var r=$(".site-search-drop");r.css("position","absolute")}var n=$.trim($("#search-shop-category").val());""!==n&&($("#search-shop-category").val(""),$("#search-shop-category").trigger("change"));var i=setInterval(function(){$(".top-searches").css("display","none"),0!=p.length?(clearInterval(i),$(".search-preloading #search-results-preloading").html(""),$(".search-preloading").hide(),e()):($(".search-preloading").show(),$(".search-preloading #search-results-preloading").html(getCirclePreloaderTpl(.26)),console.log("waiting for allItems variable to be set"))},500)}})},e}(),$(".drop-category #shop-category2").on("change",function(e){if(e.preventDefault(),"cat--01"==$(this).val())$(".src__shops").show(),$(".src__offers").hide(),$(".src__events").hide(),fnmanagenotification(ArrMainSrchExactShops.length>0||ArrMainSrchRelatedShops.length>0?0:1);else if("cat--02"==$(this).val())$(".src__shops").hide(),$(".src__offers").show(),$(".src__events").hide(),fnmanagenotification(ArrMainSrchExactOffers.length>0||ArrMainSrchRelatedOffers.length>0?0:1);else if("cat--03"==$(this).val())$(".src__shops").hide(),$(".src__offers").hide(),$(".src__events").show(),fnmanagenotification(ArrMainSrchExactEvents.length>0||ArrMainSrchRelatedEvents.length>0?0:1);else{$(".src__shops").show(),$(".src__offers").show(),$(".src__events").show();var t=parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)+parseInt(count2)+parseInt(count3);fnmanagenotification(t>0?0:1)}}),$(function(){$("#filteredOffer").each(function(){var e=0;$(".panel-card").each(function(){$(this).height()>e&&(e=$(this).height())}),$("#filteredOffer .panel-card").css("height",e)})}),$("#search-shop-category").on("change",function(e){var t=$.trim($("#search-shop-category").val()),a=$.trim($("#q").val());if(""!=t)var r=t.toLowerCase();else var r="";if(""!=a)var n=a.toLowerCase();else var n="";if($("#filteredShop:first .list").removeClass("hidden2"),""!=r){var i=new RegExp("^"+n+"$","i"),o=new RegExp(n,"i"),s=new RegExp("\\b"+n+"\\b","i");ArrMainSrchExactShops=[],ArrMainSrchRelatedShops=[],itemsToShow=0,count1=0,$.each(ArrMainSrchAllShops,function(e,t){(i.test(t.name)||appModules.filterData.filterSearchkeyWithStoreTags(n,t.tags,1))&&appModules.filterData.filterSearchkeyWithStoreTags(r,t.categories,1)?(ArrMainSrchExactShops.push(t),count1++,$("#filteredShop #main-top-srch-shop-"+t.id).removeClass("hidden2")):(o.test(t.name)||s.test(t.description)||appModules.filterData.filterSearchkeyWithStoreTags(n,t.tags,0))&&appModules.filterData.filterSearchkeyWithStoreTags(r,t.categories,1)?(ArrMainSrchRelatedShops.push(t),$("#filteredShop #main-top-srch-shop-"+t.id).addClass("hidden2")):$("#filteredShop #main-top-srch-shop-"+t.id).addClass("hidden2")}),countShop=count1,FnManageRelatedSearchShops(),FnShopShowMore();var l=parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)+parseInt(count2)+parseInt(count3);$("#srch_count_all").text(l),$("#srch_count_shop").text(parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)),$("#srch_count_offer").text(count2),$("#srch_count_event").text(count3)}else $("#q").trigger("keyup")}),$("#showMore").on("click",function(e){e.preventDefault(),FnShopShowMore()}),$("#relatedshop-showMore").on("click",function(e){e.preventDefault(),FnRelatedShopShowMore()}),$("#offershowMore").on("click",function(e){e.preventDefault(),FnOfferShowMore()}),$("#related-offershowMore").on("click",function(e){e.preventDefault(),FnRelatedOfferShowMore()}),$("#eventshowMore").on("click",function(e){e.preventDefault(),FnEventShowMore()}),$("#related-eventshowMore").on("click",function(e){e.preventDefault(),FnRelatedEventShowMore()}),$("#main-top-srch-refine-srch").on("click",function(e){$("#q").focus()}),$("#main-top-srch-srch-again").on("click",function(e){$("#q").val(""),$("#q").trigger("keyup")}),$(".sub-nav--search").on("click","a",function(){var e=$(this).data("filter");if("src__shops"==e)fnmanagenotification(ArrMainSrchExactShops.length>0||ArrMainSrchRelatedShops.length>0?0:1);else if("src__offers"==e)fnmanagenotification(ArrMainSrchExactOffers.length>0||ArrMainSrchRelatedOffers.length>0?0:1);else if("src__events"==e)fnmanagenotification(ArrMainSrchExactEvents.length>0||ArrMainSrchRelatedEvents.length>0?0:1);else{var t=parseInt(count1)+parseInt(ArrMainSrchRelatedShops.length)+parseInt(count2)+parseInt(count3);fnmanagenotification(t>0?0:1)}}),$(".search-results--content").on("click","a.search-routing",function(e){e.preventDefault();var t=$("#q").val().toLowerCase(),a=$(this).data("target-url");try{console.log(t),console.log(a),t&&"null"!==t&&(document.cookie="keyword="+t+";path=/"),location.href=a}catch(r){location.href=a}}),$(document).on("click","[data-toggle]",function(e){var t=$(this).data();switch(t.toggle){case"toggle-search":e.preventDefault(),$(t.target).fadeToggle(350),$(t.target).toggleClass("active"),1!==$(".site-search-drop.active").length?($(".search-section").not(".top-searches, .search-input").fadeOut(350),$(".top-searches, .search-input").fadeIn(1)):($(".input--search").focus(),$("html, body").scrollTop(0)),$(this).find('[data-view="open"]').toggleClass("hidden"),$(this).find('[data-view="close"]').toggleClass("hidden"),$(".site-sections").toggleClass("hidden"),$(siteHeader.settings.menu).toggle(),$("#site-menu-button").toggle(),$(".site-sections").hasClass("hidden")||($(".homeCarousel").slick("unslick"),$(".homeCarousel").slick("init"),$(".shopLandingCarousel").slick("unslick"),$(".shopLandingCarousel").slick("init"),$(".dineLandingCarousel").slick("unslick"),$(".dineLandingCarousel").slick("init"));break;case"search-debug":e.preventDefault(),$(".search-section").not(".top-searches").fadeIn(350),$(".top-searches").fadeOut(350);break;case"filter-search":e.preventDefault(),$(".sub-nav--search a").not(this).removeClass("active"),$(this).addClass("active"),"all"==t.filter?$(".search-results--content").fadeIn(350):($(".search-results--content").not("."+t.filter).fadeOut(350),$("."+t.filter).fadeIn(350));break;case"toggle-menu":e.preventDefault(),$(t.target).toggleClass("open"),$(t.target).hasClass("open")?($("#site-collapse-menu").removeClass("hidden"),$("#site-collapse-menu-footer").addClass("hidden"),$("#site-search-button").addClass("hidden"),$(".site").addClass("hidden"),$("html, body").animate({scrollTop:0},200)):($("#site-collapse-menu").addClass("hidden"),$("#site-collapse-menu-footer").removeClass("hidden"),$(".site").removeClass("hidden"),$("#site-search-button").removeClass("hidden")),$("*[data-footer-mobile-menu]").fadeToggle(350);break;case"touch-show-details":e.preventDefault();var a=$(this).attr("href"),r=$(a),n=$(".mobile-swipe-pane");n.addClass("active"),r.removeClass("hidden");break;case"touch-hide-details":e.preventDefault();var a=$(this).attr("href"),r=$(a),n=$(".mobile-swipe-pane");n.removeClass("active"),r.addClass("hidden")}}),$(document).on("click","[data-scroll-to]",function(e){e.preventDefault();var t=$(this).attr("href");$("html, body").animate({scrollTop:$(t).offset().top-95},{duration:750})}),$(".map-overlay").click(function(){$(this).css("display","none")}),$(document).ready(function(){$(".js--accordion").accordion()}),$("[data-footer-lang-toggle]").click(function(e){$(this).find("span").fadeToggle(1),$(".footer__lang-sel-wrap").fadeToggle(350),e.preventDefault()});var Plugins={init:function(){function e(){$(window).width()<=480?$("[data-slick-sm]").each(function(e){var t=$(this).data(),a=t.slickOptions.replace(/'/g,'"'),r=JSON.parse(a);$(this).slick(r)}):$("[data-slick-sm]").each(function(e){$(this).hasClass("slick-initialized")&&$(this).slick("unslick")})}function t(){var e;return e=$(window).width()<=766?"xs":$(window).width()>766&&$(window).width()<992?"sm":$(window).width()>=992&&$(window).width()<=1440?"md":"lg",$("#breakpoint").html(e),e}function a(){var e=t();$("[data-block-height]").each(function(){var t=$(this),a=$(this).data(e);$(this).parent().find("[data-block]").css({height:Number(t.outerHeight())}),$(this).parent().css({height:Number(t.outerHeight()*a)})})}$("[data-slick]").length&&$("[data-slick]").each(function(e){var t=$(this).data(),a=t.slickOptions.replace(/'/g,'"'),r=JSON.parse(a);$(this).slick(r)}),$(document).on(main.settings.click,"[data-slick-prev]",function(e){var t=$(this).data("slick-target");$(t).slick("slickPrev")}),$(document).on(main.settings.click,"[data-slick-next]",function(e){var t=$(this).data("slick-target");$(t).slick("slickNext")}),$(window).resize(function(){e()}),e(),main.settings.mobile_check?($("[data-video]").hide(),$("[data-video-fallback]").each(function(e){var t=$(this).data("video-fallback");$(t).removeClass("hidden")})):$("[data-video]").length&&$("[data-video]").each(function(e){var t=document.getElementById($(this).attr("id"));t.play()}),$(window).resize(function(){a()}),a()}};$(document).ready(function(){Plugins.init()}),mainApp=function(){var e={};return e.showNotifyMessage=function(e,t,a){var r,n={},i={},o=e||"Enter a message to show!";if(a=a||3e3,"object"==typeof e&&(o=e.message||e.msg,e.title&&(r=e.title)),r&&r.length&&(n.title=r),t)switch(t){case"error":n.icon="fa fa-ban",i.type="danger";break;case"warning":n.icon="fa fa-exclamation-triangle",i.type="warning";break;case"success":n.icon="fa fa-check",i.type="success"}n.message=o,i.allow_dismiss=!0,i.newest_on_top=!0,i.delay=a,i.placement={from:"top",align:"center"},i.height="10px",i.offset={y:5},i.animate={enter:"animated fadeInDown",exit:"animated fadeOutUp"},$.notify(n,i)},e.init=function(){if($('.tag-list a[data-btn-type="more"]').length){var e=$('.tag-list a[data-btn-type="more"]');e.click(function(t){t.preventDefault(),$(".tag-list a.btn").removeClass("hidden"),e.hide()})}$(".facebookShareBtn").click(function(e){e.preventDefault(),FB.ui({method:"share",href:window.location.href},function(e){})}),$("a[href*=#]").click(function(e){if($(this).data("anchor-linkto")){var t=$(this).attr("data-anchor-linkto"),a=$('[data-anchor-id="'+t+'"]'),r=0;r=a.data("anchor-scrolltop")?a.data("anchor-scrolltop"):$('[data-anchor-id="'+t+'"]').offset().top-130,$("html, body").animate({scrollTop:r},750)}e.preventDefault()})},e}(),moment.locale("en");var GblTopSearch=0,GblDefaultLang="en";$(document).ready(function(){if("undefined"==typeof window.ParsleyConfig.i18n&&(window.ParsleyConfig.i18n={}),window.ParsleyConfig.i18n.en=window.ParsleyLocaleData.data,window.projectConfig.projectSettings=JSON.parse($("#project-settings").text()),GblDefaultLang=window.projectConfig.projectSettings.defaultLanguage,mainApp.init(),appModules.myDeck.init(),appModules.newsletterPopup.init(),appModules.newsletter.init(),appModules.styleSelectBoxes.init(),appModules.selectBoxes.init(),void 0!==$(".homeCarousel").html()){appModules.showHomeCarousel.init();var e=window.projectConfig.projectSettings.todayTimestamp;if(parseInt(e)<=1515542400)try{$("body").flurry("destroy")}catch(t){}finally{$("body").flurry({character:"â†",color:["#FFF","#000"],height:800,frequency:100,speed:4e3,small:8,large:48,wind:60,windVariance:20,rotation:0,rotationVariance:90,startOpacity:1,endOpacity:0,opacityEasing:"cubic-bezier(1,.3,.6,.74)",blur:!0,overflow:"hidden",zIndex:9999}),"ar"==GblDefaultLang&&$(".flurry-container").css("direction","ltr")}}void 0!==$("#michello-map").html()&&(appModules.michelleMap.init(),$(window).resize(function(){})),void 0!==$(".instagram-slider-mc").html()&&$(window).load(function(){appModules.instagram.init()}),void 0!==$("#store-directory-item-tpl").html()&&appModules.pageStoreDirectory.init(),void 0!==$("#slider-offers-and-events-tpl").html()&&appModules.sliderOffersAndEvents.init(),void 0!==$("#slider-dont-miss-out-tpl").html()&&appModules.sliderDontMiss.init(),void 0!==$("#slider-offers-you-may-like-tpl").html()&&appModules.youAlsoMayLikeOffers.init(),void 0!==$("#slider-featured-stores-tpl").html()&&appModules.showFeaturedStores.init(),void 0!==$("#slider-offers-detail-tpl").html(),void 0!==$(".offerFeaturedCarousel").html()&&appModules.offerFeaturedCarousel.init(),void 0!==$(".eventFeaturedCarousel").html()&&appModules.eventFeaturedCarousel.init(),void 0!==$(".whatsnewpage").html()&&appModules.whatsnew.init(),void 0!==$("#offers-item-tpl").html()&&appModules.pageOfferSearch.init(),void 0!==$("#events-item-tpl").html()&&appModules.pageEventSearch.init(),$('div[data-offer-detailpage="true"]').length&&appModules.pageOfferDetail.init(),$('div[data-event-detailpage="true"]').length&&appModules.pageEventDetail.init(),void 0!==$(".stayOfferCarousel").html()&&appModules.stayOffer.init(),void 0!==$(".shopLandingCarousel").html()&&appModules.shopLanding.init(),void 0!==$(".dineLandingCarousel").html()&&appModules.dineLanding.init(),void 0!==$(".fashion-avenue-page").html()&&appModules.pageFashionAvenue.init(),void 0!==$(".stay-page").html()&&appModules.pageStay.init(),void 0!==$(".home-page").html()&&appModules.pageHome.init(),void 0!==$(".planYourVisitOpeningsPage").html()&&appModules.pagePlanYourVisitOpeningsPage.init(),void 0!==$(".planYourVisitGettingHerePage").html()&&appModules.pagePlanYourVisitGettingHere.init(),void 0!==$(".planYourVisitServices").html()&&appModules.pagePlanYourVisitServices.init(),void 0===$(".megamenuEntertainment").html()&&void 0===$(".megamenuStay").html()||appModules.megaMenuEntertainmentStay.init(),void 0!==$("#videoPlayer").html()&&appModules.showVideo.init(),void 0!==$("#pageBronze").html()&&appModules.mapHeight.init(),void 0!==$(".invert").html()&&$(".invert").invertImages(),void 0!==$("#michello-map").html()&&$("#michello-map").on("load",function(){var e=jQuery("#michello-map").contents().find("head"),t='<style type="text/css">#micello-map > div:last-child{display:none !important}; </style>';jQuery(e).append(t)}),void 0!==$("#refineEvents").html()&&($("#refineEvents").addClass("hidden"),$("#refineEvents").on("click",function(e){e.preventDefault(),$(this).addClass("hidden"),$("html, body").animate({scrollTop:$("#test").offset().top},1e3,function(){$("#search-shop-events").val(""),$("#search-shop-events").focus()})}),$("#search-shop-offer-form").on("submit",function(e){return e.preventDefault(),!1})),void 0!==$("#refineOffers").html()&&($("#refineOffers").addClass("hidden"),$("#refineOffers").on("click",function(e){e.preventDefault(),$(this).addClass("hidden"),$("html, body").animate({scrollTop:$("#test").offset().top},1e3,function(){$("#search-shop-offers").val(""),$("#search-shop-offers").focus()})}),$("#search-shop-offer-form").on("submit",function(e){return e.preventDefault(),!1})),$(document).on("click","#site-search-button span[data-view='open']",function(){if(0==GblTopSearch&&(GblTopSearch=1,appModules.mainSearch.init()),navigator.userAgent.indexOf("Android")>-1){var e=$(".site-search-drop");e.css("position","fixed")}$(".site-footer").css("display","none")}),$(document).on("click","#site-search-button span[data-view='close']",function(){if(navigator.userAgent.indexOf("Android")>-1){var e=$(".site-search-drop");e.css("position","absolute")}$(".site-footer").css("display","block")}),void 0===$(".shopLandingCarousel").html()&&void 0===$(".dineLandingCarousel").html()||(GblTopSearch=1,appModules.mainSearch.init()),void 0!=$(".wifi-search-page").html()&&appModules.mainSearch.init(),void 0!=$("#fitness-section").html()&&appModules.pageFitness.init(),void 0!==$(".UByEmaarPage").html()&&appModules.pageUByEmaar.init(),$(".site-header__search").css("display","none"),$(".wecare-data-slide").on("click",function(){$(".wecare-data").slideToggle("fast")}),void 0!==$("#pageMallWideEvent").html()&&appModules.mallWideOffers.init(),void 0!==$("#pageMallWideDFFEvent").html()&&appModules.mallWideDffEvent.init(),void 0!==$("#mall_event_wide_page").html()&&appModules.mall_event_wide_page.init()}),$(window).load(function(){$(".site-header__search").css("display","block")});